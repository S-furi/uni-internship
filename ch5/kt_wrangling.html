

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Data Wrangling with Kotlin &#8212; Data Science with Kotlin</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ch5/kt_wrangling';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Data Visualization" href="../ch6/intro_plotting.html" />
    <link rel="prev" title="Data Wrangling" href="intro_wrangling.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../Introduction.html">
  
  
  
  
  
    <p class="title logo__title">Data Science with Kotlin</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../Introduction.html">
                    Data Science with Kotlin
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch1/Arrays%26Matrices.html">Working with Arrays and Matrices</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch1/Multik_Arrays.html">Kotlin NDArrays</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch2/Data_Manipulation.html">Data Analysis and Manipulation Tools</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch2/Intro_dataframe.html">Data handling with Dataframe</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ch3/io.html">Data Loading and Storage</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch4/Intro_DataCleaning.html">Data Cleaning and Preparation</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch4/kt_data_manipulation.html">Data Preparation with Kotlin</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="intro_wrangling.html">Data Wrangling</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Data Wrangling with Kotlin</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch6/intro_plotting.html">Data Visualization</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch6/kt_plotting.html">Visualizing Data in Kotlin</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch7/intro_aggregation_grouping.html">Data Aggregation and Group Operations</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch7/kt_aggregation.html">Data Grouping and Aggregation with Kotlin</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../DA_examples/DA_Introduction.html">Data Analysis Examples</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../DA_examples/tips_kotlin.html">Kotlin: Tips Dataset</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/S-furi/uni-internship/tree/report/report" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/S-furi/uni-internship/tree/report/report/issues/new?title=Issue%20on%20page%20%2Fch5/kt_wrangling.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/ch5/kt_wrangling.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Data Wrangling with Kotlin</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#columngroup-and-framecolumn"><code class="docutils literal notranslate"><span class="pre">ColumnGroup</span></code> and <code class="docutils literal notranslate"><span class="pre">FrameColumn</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-multiple-dataframes">Working with Multiple DataFrames</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reshaping-and-pivoting">Reshaping and Pivoting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusions">Conclusions</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="data-wrangling-with-kotlin">
<h1>Data Wrangling with Kotlin<a class="headerlink" href="#data-wrangling-with-kotlin" title="Permalink to this heading">#</a></h1>
<p>In this chapter we will explore some tools and strategies that Kotlin DataFrame offers for all the tasks involved in data wrangling, alongside their python’s counterparts.</p>
<p>As always, we will import Kotlin DataFrame with the magic command:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">use</span><span class="w"> </span><span class="n">dataframe</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">            <div id="kotlin_out_0"></div>
            <script type="text/javascript">
                            if(!window.kotlinQueues) {
                window.kotlinQueues = {};
            }
            if(!window.kotlinQueues["DataFrame"]) {
                var resQueue = [];
                window.kotlinQueues["DataFrame"] = resQueue;
                window["call_DataFrame"] = function(f) {
                    resQueue.push(f);
                }
            }
            (function (){
                var modifiers = [(function(script) {
    script.src = "https://cdn.jsdelivr.net/gh/Kotlin/dataframe@3db46ccccaa1291c0627307d64133317f545e6ae/core/src/main/resources/init.js"
    script.type = "text/javascript";
})];
                var e = document.getElementById("kotlin_out_0");
                modifiers.forEach(function (gen) {
                    var script = document.createElement("script");
                    gen(script)
                    script.addEventListener("load", function() {
                        window["call_DataFrame"] = function(f) {f();};
                        window.kotlinQueues["DataFrame"].forEach(function(f) {f();});
                        window.kotlinQueues["DataFrame"] = [];
                    }, false);
                    script.addEventListener("error", function() {
                        window["call_DataFrame"] = function(f) {};
                        window.kotlinQueues["DataFrame"] = [];
                        var div = document.createElement("div");
                        div.style.color = 'darkred';
                        div.textContent = 'Error loading resource DataFrame';
                        document.getElementById("kotlin_out_0").appendChild(div);
                    }, false);
                    
                    e.appendChild(script);
                });
            })();
            </script></div><div class="output text_html">                <style>
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}


                </style></div></div>
</div>
<p>Before digging into data wrangling techniques that DataFrame offers, there is one Column type that has not been covered extensively yet: <code class="docutils literal notranslate"><span class="pre">ColumnGroup</span></code>.</p>
<section id="columngroup-and-framecolumn">
<h2><code class="docutils literal notranslate"><span class="pre">ColumnGroup</span></code> and <code class="docutils literal notranslate"><span class="pre">FrameColumn</span></code><a class="headerlink" href="#columngroup-and-framecolumn" title="Permalink to this heading">#</a></h2>
<p>They are a special kind of columns that contains a series of column (in <code class="docutils literal notranslate"><span class="pre">ColumnGroup</span></code>s) or a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<p>The power of those structures is the ability to store and organize data in a <strong>hierarchical</strong> way. This is essential when dealing with JSON serialization and deserialization.</p>
<p>Dealing with <em>“nested”</em> objects can also occur very often when using grouping and pivoting operations (discussed in next chapter), and a minimum comprehension is required before dealing with those operations.</p>
<p>Let’s consider a Dataframe of people with the following informations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="nv">name</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">columnOf</span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;Woody Allen&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;Bob Dylan&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;Charlie Chaplin&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;John Coltrane&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;Bob Marley&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;Linus Torvalds&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;Charlie Parker&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="kd">val</span><span class="w"> </span><span class="nv">age</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">columnOf</span><span class="p">(</span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="m">45</span><span class="p">,</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="m">30</span><span class="p">,</span><span class="w"> </span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="m">22</span><span class="p">,</span><span class="w"> </span><span class="m">57</span><span class="p">)</span>
<span class="kd">val</span><span class="w"> </span><span class="nv">city</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">columnOf</span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;Rome&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;Moscow&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;Tirana&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;Sarajevo&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;Cesena&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;Kyoto&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="kd">val</span><span class="w"> </span><span class="nv">weight</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">columnOf</span><span class="p">(</span><span class="m">55</span><span class="p">,</span><span class="w"> </span><span class="m">70</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="m">80</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="m">90</span><span class="p">)</span>
<span class="kd">val</span><span class="w"> </span><span class="nv">isDied</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">columnOf</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span>

<span class="kd">val</span><span class="w"> </span><span class="nv">people</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataFrameOf</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">city</span><span class="p">,</span><span class="w"> </span><span class="n">weight</span><span class="p">,</span><span class="w"> </span><span class="n">isDied</span><span class="p">)</span>
<span class="n">people</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_1728053248"></table>

<p class="dataframe_description">DataFrame: rowsCount = 7, columnsCount = 5</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"name: String\">name</span>", children: [], rightAlign: false, values: ["Woody Allen","Bob Dylan","Charlie Chaplin","John Coltrane","Bob Marley","Linus Torvalds","Charlie Parker"] }, 
{ name: "<span title=\"age: Int\">age</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">15</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">45</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">20</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">30</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">15</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">22</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">57</span></span>"] }, 
{ name: "<span title=\"city: String?\">city</span>", children: [], rightAlign: false, values: ["Rome","Moscow","Tirana","Sarajevo","Cesena","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","Kyoto"] }, 
{ name: "<span title=\"weight: Int?\">weight</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">55</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">70</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">80</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">90</span></span>"] }, 
{ name: "<span title=\"isDied: Boolean\">isDied</span>", children: [], rightAlign: false, values: ["false","false","true","true","true","false","true"] }, 
], id: 1728053248, rootId: 1728053248, totalRows: 7 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(1728053248) });


        </script>
        </html></div></div>
</div>
<p>Creating a group of columns is pretty straightforward:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">people</span><span class="p">.</span><span class="na">group</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">city</span><span class="w"> </span><span class="p">}.</span><span class="na">into</span><span class="p">(</span><span class="s">&quot;group&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_1728053249"></table>

<p class="dataframe_description">DataFrame: rowsCount = 7, columnsCount = 4</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"name: String\">name</span>", children: [], rightAlign: false, values: ["Woody Allen","Bob Dylan","Charlie Chaplin","John Coltrane","Bob Marley","Linus Torvalds","Charlie Parker"] }, 
{ name: "<span title=\"age: Int\">age</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">15</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">45</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">20</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">30</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">15</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">22</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">57</span></span>"] }, 
{ name: "<span title=\"city: String?\">city</span>", children: [], rightAlign: false, values: ["Rome","Moscow","Tirana","Sarajevo","Cesena","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","Kyoto"] }, 
{ name: "<span title=\"group: DataRow\">group</span>", children: [1, 2], rightAlign: false, values: ["<span class=\"formatted\" title=\"age: 15\ncity: Rome\"><span class=\"structural\">{ </span><span class=\"structural\">age: </span><span class=\"numbers\">15</span><span class=\"structural\">, </span><span class=\"structural\">city: </span>Rome<span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"age: 45\ncity: Moscow\"><span class=\"structural\">{ </span><span class=\"structural\">age: </span><span class=\"numbers\">45</span><span class=\"structural\">, </span><span class=\"structural\">city: </span>Moscow<span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"age: 20\ncity: Tirana\"><span class=\"structural\">{ </span><span class=\"structural\">age: </span><span class=\"numbers\">20</span><span class=\"structural\">, </span><span class=\"structural\">city: </span>Tirana<span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"age: 30\ncity: Sarajevo\"><span class=\"structural\">{ </span><span class=\"structural\">age: </span><span class=\"numbers\">30</span><span class=\"structural\">, </span><span class=\"structural\">city: </span>Sarajevo<span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"age: 15\ncity: Cesena\"><span class=\"structural\">{ </span><span class=\"structural\">age: </span><span class=\"numbers\">15</span><span class=\"structural\">, </span><span class=\"structural\">city: </span>Cesena<span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"age: 22\"><span class=\"structural\">{ </span><span class=\"structural\">age: </span><span class=\"numbers\">22</span><span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"age: 57\ncity: Kyoto\"><span class=\"structural\">{ </span><span class=\"structural\">age: </span><span class=\"numbers\">57</span><span class=\"structural\">, </span><span class=\"structural\">city: </span>Kyoto<span class=\"structural\"> }</span></span>"] }, 
{ name: "<span title=\"weight: Int?\">weight</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">55</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">70</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">80</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">90</span></span>"] }, 
{ name: "<span title=\"isDied: Boolean\">isDied</span>", children: [], rightAlign: false, values: ["false","false","true","true","true","false","true"] }, 
], id: 1728053249, rootId: 1728053249, totalRows: 7 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(1728053249) });


        </script>
        </html></div></div>
</div>
<p>We can also create a nested column, for example, splitting the name in a <code class="docutils literal notranslate"><span class="pre">firstName</span></code> and a <code class="docutils literal notranslate"><span class="pre">lastName</span></code> column:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="nv">groupedDf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">people</span><span class="p">.</span><span class="na">split</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="p">}.</span><span class="na">by</span><span class="p">(</span><span class="sc">&#39; &#39;</span><span class="p">).</span><span class="na">inward</span><span class="p">(</span><span class="s">&quot;firstName&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;lastName&quot;</span><span class="p">)</span>
<span class="n">groupedDf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_1728053250"></table>

<p class="dataframe_description">DataFrame: rowsCount = 7, columnsCount = 5</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"firstName: String\">firstName</span>", children: [], rightAlign: false, values: ["Woody","Bob","Charlie","John","Bob","Linus","Charlie"] }, 
{ name: "<span title=\"lastName: String\">lastName</span>", children: [], rightAlign: false, values: ["Allen","Dylan","Chaplin","Coltrane","Marley","Torvalds","Parker"] }, 
{ name: "<span title=\"name: DataRow\">name</span>", children: [0, 1], rightAlign: false, values: ["<span class=\"formatted\" title=\"firstName: Woody\nlastName: Allen\"><span class=\"structural\">{ </span><span class=\"structural\">firstName: </span>Woody<span class=\"structural\">, </span><span class=\"structural\">lastName: </span>Allen<span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"firstName: Bob\nlastName: Dylan\"><span class=\"structural\">{ </span><span class=\"structural\">firstName: </span>Bob<span class=\"structural\">, </span><span class=\"structural\">lastName: </span>Dylan<span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"firstName: Charlie\nlastName: Chaplin\"><span class=\"structural\">{ </span><span class=\"structural\">firstName: </span>Charlie<span class=\"structural\">, </span><span class=\"structural\">lastName: </span>Cha<span class=\"structural\">...</span><span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"firstName: John\nlastName: Coltrane\"><span class=\"structural\">{ </span><span class=\"structural\">firstName: </span>John<span class=\"structural\">, </span><span class=\"structural\">lastName: </span>Coltrane<span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"firstName: Bob\nlastName: Marley\"><span class=\"structural\">{ </span><span class=\"structural\">firstName: </span>Bob<span class=\"structural\">, </span><span class=\"structural\">lastName: </span>Marley<span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"firstName: Linus\nlastName: Torvalds\"><span class=\"structural\">{ </span><span class=\"structural\">firstName: </span>Linus<span class=\"structural\">, </span><span class=\"structural\">lastName: </span>Torvalds<span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"firstName: Charlie\nlastName: Parker\"><span class=\"structural\">{ </span><span class=\"structural\">firstName: </span>Charlie<span class=\"structural\">, </span><span class=\"structural\">lastName: </span>Parker<span class=\"structural\"> }</span></span>"] }, 
{ name: "<span title=\"age: Int\">age</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">15</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">45</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">20</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">30</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">15</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">22</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">57</span></span>"] }, 
{ name: "<span title=\"city: String?\">city</span>", children: [], rightAlign: false, values: ["Rome","Moscow","Tirana","Sarajevo","Cesena","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","Kyoto"] }, 
{ name: "<span title=\"weight: Int?\">weight</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">55</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">70</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">80</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">90</span></span>"] }, 
{ name: "<span title=\"isDied: Boolean\">isDied</span>", children: [], rightAlign: false, values: ["false","false","true","true","true","false","true"] }, 
], id: 1728053250, rootId: 1728053250, totalRows: 7 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(1728053250) });


        </script>
        </html></div></div>
</div>
<p>Using the <code class="docutils literal notranslate"><span class="pre">inward()</span></code> method splits the columns into the provided column names, nesting the inside the original column, creating a <code class="docutils literal notranslate"><span class="pre">ColumnGroup</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">groupedDf</span><span class="p">.</span><span class="na">name</span><span class="p">.</span><span class="na">javaClass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>class org.jetbrains.kotlinx.dataframe.impl.columns.ColumnGroupImpl
</pre></div>
</div>
</div>
</div>
<p>We can always access the fields of the <code class="docutils literal notranslate"><span class="pre">ColumnGroup</span></code> with the <code class="docutils literal notranslate"><span class="pre">.</span></code> notation</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">groupedDf</span><span class="p">.</span><span class="na">name</span><span class="p">.</span><span class="na">firstName</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_1728053251"></table>

<p class="dataframe_description">DataColumn: name = "firstName", type = String, size = 7</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"firstName: String\">firstName</span>", children: [], rightAlign: false, values: ["Woody","Bob","Charlie","John","Bob","Linus","Charlie"] }, 
], id: 1728053251, rootId: 1728053251, totalRows: 7 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(1728053251) });


        </script>
        </html></div></div>
</div>
<p>As said above, most of the time we will have to deal with these nested structures when using <code class="docutils literal notranslate"><span class="pre">pivot</span></code> or <code class="docutils literal notranslate"><span class="pre">groupBy</span></code> methods.
We can, for example, pivot the table to create columns that contains a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>: <code class="docutils literal notranslate"><span class="pre">FrameColumns</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">groupedDf</span><span class="p">.</span><span class="na">pivot</span><span class="p">{</span><span class="w"> </span><span class="n">name</span><span class="p">.</span><span class="na">firstName</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_1728053252"></table>

<p class="dataframe_description">Pivot</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"Woody: DataFrame\">Woody</span>", children: [], rightAlign: false, values: [{ frameId: 1728053253, value: "<b>DataFrame 1 x 5</b>" }] }, 
{ name: "<span title=\"Bob: DataFrame\">Bob</span>", children: [], rightAlign: false, values: [{ frameId: 1728053254, value: "<b>DataFrame 2 x 5</b>" }] }, 
{ name: "<span title=\"Charlie: DataFrame\">Charlie</span>", children: [], rightAlign: false, values: [{ frameId: 1728053255, value: "<b>DataFrame 2 x 5</b>" }] }, 
{ name: "<span title=\"John: DataFrame\">John</span>", children: [], rightAlign: false, values: [{ frameId: 1728053256, value: "<b>DataFrame 1 x 5</b>" }] }, 
{ name: "<span title=\"Linus: DataFrame\">Linus</span>", children: [], rightAlign: false, values: [{ frameId: 1728053257, value: "<b>DataFrame 1 x 5</b>" }] }, 
], id: 1728053252, rootId: 1728053252, totalRows: 1 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"firstName: String\">firstName</span>", children: [], rightAlign: false, values: ["Woody"] }, 
{ name: "<span title=\"lastName: String\">lastName</span>", children: [], rightAlign: false, values: ["Allen"] }, 
{ name: "<span title=\"name: DataRow\">name</span>", children: [0, 1], rightAlign: false, values: ["<span class=\"formatted\" title=\"firstName: Woody\nlastName: Allen\"><span class=\"structural\">{ </span><span class=\"structural\">firstName: </span>Woody<span class=\"structural\">, </span><span class=\"structural\">lastName: </span>Allen<span class=\"structural\"> }</span></span>"] }, 
{ name: "<span title=\"age: Int\">age</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">15</span></span>"] }, 
{ name: "<span title=\"city: String\">city</span>", children: [], rightAlign: false, values: ["Rome"] }, 
{ name: "<span title=\"weight: Int\">weight</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">55</span></span>"] }, 
{ name: "<span title=\"isDied: Boolean\">isDied</span>", children: [], rightAlign: false, values: ["false"] }, 
], id: 1728053253, rootId: 1728053252, totalRows: 1 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"firstName: String\">firstName</span>", children: [], rightAlign: false, values: ["Bob","Bob"] }, 
{ name: "<span title=\"lastName: String\">lastName</span>", children: [], rightAlign: false, values: ["Dylan","Marley"] }, 
{ name: "<span title=\"name: DataRow\">name</span>", children: [0, 1], rightAlign: false, values: ["<span class=\"formatted\" title=\"firstName: Bob\nlastName: Dylan\"><span class=\"structural\">{ </span><span class=\"structural\">firstName: </span>Bob<span class=\"structural\">, </span><span class=\"structural\">lastName: </span>Dylan<span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"firstName: Bob\nlastName: Marley\"><span class=\"structural\">{ </span><span class=\"structural\">firstName: </span>Bob<span class=\"structural\">, </span><span class=\"structural\">lastName: </span>Marley<span class=\"structural\"> }</span></span>"] }, 
{ name: "<span title=\"age: Int\">age</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">45</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">15</span></span>"] }, 
{ name: "<span title=\"city: String\">city</span>", children: [], rightAlign: false, values: ["Moscow","Cesena"] }, 
{ name: "<span title=\"weight: Int?\">weight</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">70</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>"] }, 
{ name: "<span title=\"isDied: Boolean\">isDied</span>", children: [], rightAlign: false, values: ["false","true"] }, 
], id: 1728053254, rootId: 1728053252, totalRows: 2 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"firstName: String\">firstName</span>", children: [], rightAlign: false, values: ["Charlie","Charlie"] }, 
{ name: "<span title=\"lastName: String\">lastName</span>", children: [], rightAlign: false, values: ["Chaplin","Parker"] }, 
{ name: "<span title=\"name: DataRow\">name</span>", children: [0, 1], rightAlign: false, values: ["<span class=\"formatted\" title=\"firstName: Charlie\nlastName: Chaplin\"><span class=\"structural\">{ </span><span class=\"structural\">firstName: </span>Charlie<span class=\"structural\">, </span><span class=\"structural\">lastName: </span>Cha<span class=\"structural\">...</span><span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"firstName: Charlie\nlastName: Parker\"><span class=\"structural\">{ </span><span class=\"structural\">firstName: </span>Charlie<span class=\"structural\">, </span><span class=\"structural\">lastName: </span>Parker<span class=\"structural\"> }</span></span>"] }, 
{ name: "<span title=\"age: Int\">age</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">20</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">57</span></span>"] }, 
{ name: "<span title=\"city: String\">city</span>", children: [], rightAlign: false, values: ["Tirana","Kyoto"] }, 
{ name: "<span title=\"weight: Int?\">weight</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">90</span></span>"] }, 
{ name: "<span title=\"isDied: Boolean\">isDied</span>", children: [], rightAlign: false, values: ["true","true"] }, 
], id: 1728053255, rootId: 1728053252, totalRows: 2 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"firstName: String\">firstName</span>", children: [], rightAlign: false, values: ["John"] }, 
{ name: "<span title=\"lastName: String\">lastName</span>", children: [], rightAlign: false, values: ["Coltrane"] }, 
{ name: "<span title=\"name: DataRow\">name</span>", children: [0, 1], rightAlign: false, values: ["<span class=\"formatted\" title=\"firstName: John\nlastName: Coltrane\"><span class=\"structural\">{ </span><span class=\"structural\">firstName: </span>John<span class=\"structural\">, </span><span class=\"structural\">lastName: </span>Coltrane<span class=\"structural\"> }</span></span>"] }, 
{ name: "<span title=\"age: Int\">age</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">30</span></span>"] }, 
{ name: "<span title=\"city: String\">city</span>", children: [], rightAlign: false, values: ["Sarajevo"] }, 
{ name: "<span title=\"weight: Int\">weight</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">80</span></span>"] }, 
{ name: "<span title=\"isDied: Boolean\">isDied</span>", children: [], rightAlign: false, values: ["true"] }, 
], id: 1728053256, rootId: 1728053252, totalRows: 1 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"firstName: String\">firstName</span>", children: [], rightAlign: false, values: ["Linus"] }, 
{ name: "<span title=\"lastName: String\">lastName</span>", children: [], rightAlign: false, values: ["Torvalds"] }, 
{ name: "<span title=\"name: DataRow\">name</span>", children: [0, 1], rightAlign: false, values: ["<span class=\"formatted\" title=\"firstName: Linus\nlastName: Torvalds\"><span class=\"structural\">{ </span><span class=\"structural\">firstName: </span>Linus<span class=\"structural\">, </span><span class=\"structural\">lastName: </span>Torvalds<span class=\"structural\"> }</span></span>"] }, 
{ name: "<span title=\"age: Int\">age</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">22</span></span>"] }, 
{ name: "<span title=\"city: String?\">city</span>", children: [], rightAlign: false, values: ["<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>"] }, 
{ name: "<span title=\"weight: Int?\">weight</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>"] }, 
{ name: "<span title=\"isDied: Boolean\">isDied</span>", children: [], rightAlign: false, values: ["false"] }, 
], id: 1728053257, rootId: 1728053252, totalRows: 1 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(1728053252) });


        </script>
        </html></div></div>
</div>
<p>As the prompt above, the dataframe suggests us that this is a <code class="docutils literal notranslate"><span class="pre">Pivot</span></code> object, and it should be a temporary object before applying an aggregate function or other manipulations. We will cover <code class="docutils literal notranslate"><span class="pre">pivot</span></code> and <code class="docutils literal notranslate"><span class="pre">groupBy</span></code> extensively in the <a class="reference internal" href="../ch7/kt_aggregation.html"><span class="doc std std-doc">chapter 7</span></a>.</p>
<p>These nested structures can resemble to a <code class="docutils literal notranslate"><span class="pre">pandas.MultiIndex</span></code>: they both express the concept of organizing data in a <strong>hierarchical</strong> way.</p>
<p>DataFrame multilevel structures differs from pandas because they do not have an explicit concept of <code class="docutils literal notranslate"><span class="pre">Index</span></code>, and operations like <code class="docutils literal notranslate"><span class="pre">pandas.dataframe.stack()/unstack()</span></code> would make no sense. In some ways that result can be accomplished with some trickery, but DataFrame’s <code class="docutils literal notranslate"><span class="pre">ColumnGroup</span></code> or <code class="docutils literal notranslate"><span class="pre">FrameColumn</span></code> are not intended to substitute <code class="docutils literal notranslate"><span class="pre">pandas.MultiIndex</span></code>, even if they’re goal is very similar.</p>
</section>
<section id="working-with-multiple-dataframes">
<h2>Working with Multiple DataFrames<a class="headerlink" href="#working-with-multiple-dataframes" title="Permalink to this heading">#</a></h2>
<p>DataFrame provides three methods for operating with multiple <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">add</span></code>: adds new <strong>columns</strong> to the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">concat</span></code>: returns the <strong>union</strong> of the provided <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">join</span></code>: SQL-like join of two <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s by <strong>key</strong> columns.</p></li>
</ul>
<p>we already have seen an application of the <code class="docutils literal notranslate"><span class="pre">add</span></code> method, but it is possible to add multiple columns all at once:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">groupedDf</span>
<span class="w">    </span><span class="p">.</span><span class="na">convert</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="p">}.</span><span class="na">toDouble</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="na">dropNA</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">.</span><span class="na">add</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="s">&quot;year of birth&quot;</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">age</span>
<span class="w">    </span><span class="n">age</span><span class="w"> </span><span class="n">gt</span><span class="w"> </span><span class="m">18</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="s">&quot;is adult&quot;</span>
<span class="w">    </span><span class="s">&quot;details&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">         </span><span class="s">&quot;weight&quot;</span><span class="o">&lt;</span><span class="kt">Double</span><span class="o">&gt;</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">6.35</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="s">&quot;weight (approx. stones)&quot;</span>
<span class="w">        </span><span class="s">&quot;full name&quot;</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">name</span><span class="p">.</span><span class="na">firstName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">name</span><span class="p">.</span><span class="na">lastName</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_1728053258"></table>

<p class="dataframe_description">DataFrame: rowsCount = 4, columnsCount = 8</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"firstName: String\">firstName</span>", children: [], rightAlign: false, values: ["Woody","Bob","John","Charlie"] }, 
{ name: "<span title=\"lastName: String\">lastName</span>", children: [], rightAlign: false, values: ["Allen","Dylan","Coltrane","Parker"] }, 
{ name: "<span title=\"name: DataRow\">name</span>", children: [0, 1], rightAlign: false, values: ["<span class=\"formatted\" title=\"firstName: Woody\nlastName: Allen\"><span class=\"structural\">{ </span><span class=\"structural\">firstName: </span>Woody<span class=\"structural\">, </span><span class=\"structural\">lastName: </span>Allen<span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"firstName: Bob\nlastName: Dylan\"><span class=\"structural\">{ </span><span class=\"structural\">firstName: </span>Bob<span class=\"structural\">, </span><span class=\"structural\">lastName: </span>Dylan<span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"firstName: John\nlastName: Coltrane\"><span class=\"structural\">{ </span><span class=\"structural\">firstName: </span>John<span class=\"structural\">, </span><span class=\"structural\">lastName: </span>Coltrane<span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"firstName: Charlie\nlastName: Parker\"><span class=\"structural\">{ </span><span class=\"structural\">firstName: </span>Charlie<span class=\"structural\">, </span><span class=\"structural\">lastName: </span>Parker<span class=\"structural\"> }</span></span>"] }, 
{ name: "<span title=\"age: Int\">age</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">15</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">45</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">30</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">57</span></span>"] }, 
{ name: "<span title=\"city: String\">city</span>", children: [], rightAlign: false, values: ["Rome","Moscow","Sarajevo","Kyoto"] }, 
{ name: "<span title=\"weight: Double\">weight</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">55.0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">70.0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">80.0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">90.0</span></span>"] }, 
{ name: "<span title=\"isDied: Boolean\">isDied</span>", children: [], rightAlign: false, values: ["false","false","true","true"] }, 
{ name: "<span title=\"year of birth: Int\">year of birth</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">2008</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1978</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1993</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1966</span></span>"] }, 
{ name: "<span title=\"is adult: Boolean\">is adult</span>", children: [], rightAlign: false, values: ["false","true","true","true"] }, 
{ name: "<span title=\"weight (approx. stones): Double\">weight (approx. stones)</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">8.661417</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">11.023622</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">12.598425</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">14.173228</span></span>"] }, 
{ name: "<span title=\"full name: String\">full name</span>", children: [], rightAlign: false, values: ["Woody Allen","Bob Dylan","John Coltrane","Charlie Parker"] }, 
{ name: "<span title=\"details: DataRow\">details</span>", children: [9, 10], rightAlign: false, values: ["<span class=\"formatted\" title=\"weight (approx. stones): 8.661417322834646\nfull name: Woody Allen\"><span class=\"structural\">{ </span><span class=\"structural\">weight (approx. stones): </span><span class=\"numbers\">8.7</span><span class=\"structural\">, </span><span class=\"structural\">ful...</span><span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"weight (approx. stones): 11.023622047244094\nfull name: Bob Dylan\"><span class=\"structural\">{ </span><span class=\"structural\">weight (approx. stones): </span><span class=\"numbers\">11.0</span><span class=\"structural\">, </span><span class=\"structural\">fu...</span><span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"weight (approx. stones): 12.598425196850394\nfull name: John Coltrane\"><span class=\"structural\">{ </span><span class=\"structural\">weight (approx. stones): </span><span class=\"numbers\">12.6</span><span class=\"structural\">, </span><span class=\"structural\">fu...</span><span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"weight (approx. stones): 14.173228346456694\nfull name: Charlie Parker\"><span class=\"structural\">{ </span><span class=\"structural\">weight (approx. stones): </span><span class=\"numbers\">14.2</span><span class=\"structural\">, </span><span class=\"structural\">fu...</span><span class=\"structural\"> }</span></span>"] }, 
], id: 1728053258, rootId: 1728053258, totalRows: 4 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(1728053258) });


        </script>
        </html></div></div>
</div>
<p>When applying <code class="docutils literal notranslate"><span class="pre">concat</span></code>, it concatenates the rows of the provided <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s or <code class="docutils literal notranslate"><span class="pre">DataColumn</span></code>s.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="nv">df1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataFrameOf</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;b&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;c&quot;</span><span class="p">).</span><span class="na">fill</span><span class="p">(</span><span class="m">5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="w"> </span><span class="p">}</span>
<span class="kd">val</span><span class="w"> </span><span class="nv">df2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataFrameOf</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;b&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;c&quot;</span><span class="p">).</span><span class="na">fill</span><span class="p">(</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="p">}</span>

<span class="n">df1</span><span class="p">.</span><span class="na">concat</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_1728053259"></table>

<p class="dataframe_description">DataFrame: rowsCount = 7, columnsCount = 3</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"a: Int\">a</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-10</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-9</span></span>"] }, 
{ name: "<span title=\"b: Int\">b</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-10</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-9</span></span>"] }, 
{ name: "<span title=\"c: Int\">c</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-10</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-9</span></span>"] }, 
], id: 1728053259, rootId: 1728053259, totalRows: 7 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(1728053259) });


        </script>
        </html></div></div>
</div>
<p>When concatenating dataframes with different column keys, the result is like a <em>full join</em> in the database world, where non matching values of the two collections are filled with <code class="docutils literal notranslate"><span class="pre">null</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="nv">df1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataFrameOf</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;b&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;c&quot;</span><span class="p">).</span><span class="na">fill</span><span class="p">(</span><span class="m">10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="w"> </span><span class="p">}</span>
<span class="kd">val</span><span class="w"> </span><span class="nv">df2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataFrameOf</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;c&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;d&quot;</span><span class="p">).</span><span class="na">fill</span><span class="p">(</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="p">}</span>

<span class="n">df1</span><span class="p">.</span><span class="na">concat</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_1728053260"></table>

<p class="dataframe_description">DataFrame: rowsCount = 12, columnsCount = 4</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"a: Int\">a</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">6</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">7</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">8</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">9</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-10</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-9</span></span>"] }, 
{ name: "<span title=\"b: Int?\">b</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">6</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">7</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">8</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">9</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>"] }, 
{ name: "<span title=\"c: Int\">c</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">6</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">7</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">8</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">9</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-10</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-9</span></span>"] }, 
{ name: "<span title=\"d: Int?\">d</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-10</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-9</span></span>"] }, 
], id: 1728053260, rootId: 1728053260, totalRows: 12 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(1728053260) });


        </script>
        </html></div></div>
</div>
<p>We can also use the <code class="docutils literal notranslate"><span class="pre">concat</span></code> method providing a <code class="docutils literal notranslate"><span class="pre">List</span></code> object</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">listOf</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span><span class="w"> </span><span class="n">df2</span><span class="p">).</span><span class="na">concat</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_1728053261"></table>

<p class="dataframe_description">DataFrame: rowsCount = 12, columnsCount = 4</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"a: Int\">a</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">6</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">7</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">8</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">9</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-10</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-9</span></span>"] }, 
{ name: "<span title=\"b: Int?\">b</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">6</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">7</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">8</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">9</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>"] }, 
{ name: "<span title=\"c: Int\">c</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">6</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">7</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">8</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">9</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-10</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-9</span></span>"] }, 
{ name: "<span title=\"d: Int?\">d</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-10</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-9</span></span>"] }, 
], id: 1728053261, rootId: 1728053261, totalRows: 12 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(1728053261) });


        </script>
        </html></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">concat</span></code> method is similar to <code class="docutils literal notranslate"><span class="pre">pandas.concat</span></code> method, with the difference that in pandas you can specify which <em>axis</em> to merge, having the <code class="docutils literal notranslate"><span class="pre">Index</span></code> object that can provide a merging key when choosing <code class="docutils literal notranslate"><span class="pre">axis=0</span></code>. On the other hand, When using <code class="docutils literal notranslate"><span class="pre">axis=1</span></code>, merging two pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s will produce a similar result to what Kotlin <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> provides.</p>
<p>If we want to use sql like <code class="docutils literal notranslate"><span class="pre">join</span></code> operations, we can use the <code class="docutils literal notranslate"><span class="pre">join</span></code> method provided by Kotlin <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">join</span></code>’s method signature is the following:</p>
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">join</span><span class="p">(</span><span class="n">otherDf</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JoinType</span><span class="p">.</span><span class="na">Inner</span><span class="p">)</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">joinColumns</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">]</span>
</pre></div>
</div>
<p>Having the join columns as optional, and the default join is set to Inner (only matched columns from left and right <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="nv">df1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataFrameOf</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;b&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;c&quot;</span><span class="p">).</span><span class="na">fill</span><span class="p">(</span><span class="m">10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="w"> </span><span class="p">}</span>
<span class="kd">val</span><span class="w"> </span><span class="nv">df2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataFrameOf</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;c&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;d&quot;</span><span class="p">).</span><span class="na">fill</span><span class="p">(</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="p">.</span><span class="na">join</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_1728053262"></table>

<p class="dataframe_description">DataFrame: rowsCount = 2, columnsCount = 4</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"a: Int\">a</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>"] }, 
{ name: "<span title=\"b: Int\">b</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>"] }, 
{ name: "<span title=\"c: Int\">c</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>"] }, 
{ name: "<span title=\"d: Int\">d</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>"] }, 
], id: 1728053262, rootId: 1728053262, totalRows: 2 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(1728053262) });


        </script>
        </html></div></div>
</div>
<p>We can specify which column to match with the <code class="docutils literal notranslate"><span class="pre">match</span></code> DSL keyword</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="p">.</span><span class="na">join</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JoinType</span><span class="p">.</span><span class="na">Full</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">right</span><span class="p">.</span><span class="na">a</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_1728053263"></table>

<p class="dataframe_description">DataFrame: rowsCount = 10, columnsCount = 5</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"a: Int\">a</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">6</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">7</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">8</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">9</span></span>"] }, 
{ name: "<span title=\"b: Int\">b</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">6</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">7</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">8</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">9</span></span>"] }, 
{ name: "<span title=\"c: Int\">c</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">6</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">7</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">8</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">9</span></span>"] }, 
{ name: "<span title=\"c1: Int?\">c1</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>"] }, 
{ name: "<span title=\"d: Int?\">d</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>"] }, 
], id: 1728053263, rootId: 1728053263, totalRows: 10 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(1728053263) });


        </script>
        </html></div></div>
</div>
<p>And you can sport that any column that matched during the join, but not included in the <code class="docutils literal notranslate"><span class="pre">joinColumn</span></code> clause, are duplicated with a new column key.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">match</span></code> keyword is used in all those cases where we can apply the join because of matching row values, but the columns keys differs by name.</p>
<p>Consider the next example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">people</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_1728053264"></table>

<p class="dataframe_description">DataFrame: rowsCount = 7, columnsCount = 5</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"name: String\">name</span>", children: [], rightAlign: false, values: ["Woody Allen","Bob Dylan","Charlie Chaplin","John Coltrane","Bob Marley","Linus Torvalds","Charlie Parker"] }, 
{ name: "<span title=\"age: Int\">age</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">15</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">45</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">20</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">30</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">15</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">22</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">57</span></span>"] }, 
{ name: "<span title=\"city: String?\">city</span>", children: [], rightAlign: false, values: ["Rome","Moscow","Tirana","Sarajevo","Cesena","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","Kyoto"] }, 
{ name: "<span title=\"weight: Int?\">weight</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">55</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">70</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">80</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">90</span></span>"] }, 
{ name: "<span title=\"isDied: Boolean\">isDied</span>", children: [], rightAlign: false, values: ["false","false","true","true","true","false","true"] }, 
], id: 1728053264, rootId: 1728053264, totalRows: 7 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(1728053264) });


        </script>
        </html></div></div>
</div>
<p>and let’s suppose we have a new dataset with new data that can be joined with the previous one</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="nv">newPeopleDf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">people</span><span class="p">.</span><span class="na">head</span><span class="p">(</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="c1">// pick just the first two</span>
<span class="w">        </span><span class="p">.</span><span class="na">rename</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">).</span><span class="na">into</span><span class="p">(</span><span class="s">&quot;fullName&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">// renameing join column</span>
<span class="w">        </span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;stonesWeight&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// add new dummy column</span>
<span class="w">            </span><span class="n">weight</span><span class="o">!!</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">6.35</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="p">.</span><span class="na">select</span><span class="p">(</span><span class="s">&quot;fullName&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;stonesWeight&quot;</span><span class="p">)</span>
<span class="w">        </span>
<span class="n">newPeopleDf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_1728053265"></table>

<p class="dataframe_description">DataFrame: rowsCount = 2, columnsCount = 2</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"fullName: String\">fullName</span>", children: [], rightAlign: false, values: ["Woody Allen","Bob Dylan"] }, 
{ name: "<span title=\"stonesWeight: Double\">stonesWeight</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">8.661417</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">11.023622</span></span>"] }, 
], id: 1728053265, rootId: 1728053265, totalRows: 2 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(1728053265) });


        </script>
        </html></div></div>
</div>
<p>We can use the <code class="docutils literal notranslate"><span class="pre">match</span></code> keyword for specifying which columns to use for the join operation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">people</span><span class="p">.</span><span class="na">join</span><span class="p">(</span><span class="n">newPeopleDf</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JoinType</span><span class="p">.</span><span class="na">Left</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">right</span><span class="p">.</span><span class="na">fullName</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_1728053266"></table>

<p class="dataframe_description">DataFrame: rowsCount = 7, columnsCount = 6</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"name: String\">name</span>", children: [], rightAlign: false, values: ["Woody Allen","Bob Dylan","Charlie Chaplin","John Coltrane","Bob Marley","Linus Torvalds","Charlie Parker"] }, 
{ name: "<span title=\"age: Int\">age</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">15</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">45</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">20</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">30</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">15</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">22</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">57</span></span>"] }, 
{ name: "<span title=\"city: String?\">city</span>", children: [], rightAlign: false, values: ["Rome","Moscow","Tirana","Sarajevo","Cesena","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","Kyoto"] }, 
{ name: "<span title=\"weight: Int?\">weight</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">55</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">70</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">80</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">90</span></span>"] }, 
{ name: "<span title=\"isDied: Boolean\">isDied</span>", children: [], rightAlign: false, values: ["false","false","true","true","true","false","true"] }, 
{ name: "<span title=\"stonesWeight: Double?\">stonesWeight</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">8.661417</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">11.023622</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>"] }, 
], id: 1728053266, rootId: 1728053266, totalRows: 7 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(1728053266) });


        </script>
        </html></div></div>
</div>
<p>There are handy shortcuts for specifying which type of join we want to perform for each kind of join. The previous code can be rewritten to:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">people</span><span class="p">.</span><span class="na">leftJoin</span><span class="p">(</span><span class="n">newPeopleDf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">right</span><span class="p">.</span><span class="na">fullName</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_1728053267"></table>

<p class="dataframe_description">DataFrame: rowsCount = 7, columnsCount = 6</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"name: String\">name</span>", children: [], rightAlign: false, values: ["Woody Allen","Bob Dylan","Charlie Chaplin","John Coltrane","Bob Marley","Linus Torvalds","Charlie Parker"] }, 
{ name: "<span title=\"age: Int\">age</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">15</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">45</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">20</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">30</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">15</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">22</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">57</span></span>"] }, 
{ name: "<span title=\"city: String?\">city</span>", children: [], rightAlign: false, values: ["Rome","Moscow","Tirana","Sarajevo","Cesena","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","Kyoto"] }, 
{ name: "<span title=\"weight: Int?\">weight</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">55</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">70</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">80</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">90</span></span>"] }, 
{ name: "<span title=\"isDied: Boolean\">isDied</span>", children: [], rightAlign: false, values: ["false","false","true","true","true","false","true"] }, 
{ name: "<span title=\"stonesWeight: Double?\">stonesWeight</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">8.661417</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">11.023622</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>"] }, 
], id: 1728053267, rootId: 1728053267, totalRows: 7 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(1728053267) });


        </script>
        </html></div></div>
</div>
<p>See the full <a class="reference external" href="https://kotlin.github.io/dataframe/join.html#join-types">reference</a> for supported types of join.</p>
</section>
<section id="reshaping-and-pivoting">
<h2>Reshaping and Pivoting<a class="headerlink" href="#reshaping-and-pivoting" title="Permalink to this heading">#</a></h2>
<p>Reshaping and Pivoting a datasets is a very common operation that is being made during Data Analysis, and Kotlin DataFrame provides a series of methods that can help the developer in the creation of different views of the same <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<p>The most common operations that are used when pivoting and reshaping a dataset, are <code class="docutils literal notranslate"><span class="pre">pivot</span></code> and <code class="docutils literal notranslate"><span class="pre">groupBy</span></code>, and very often they’re used chained together for distributing data along rows or columns.</p>
<p>We will run all the examples with the <code class="docutils literal notranslate"><span class="pre">macrodata</span></code> dataset</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="nv">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DataFrame</span><span class="p">.</span><span class="na">readCSV</span><span class="p">(</span><span class="s">&quot;../resources/example-datasets/datasets/macrodata.csv&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="na">head</span><span class="p">(</span><span class="m">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_1728053268"></table>

<p class="dataframe_description">DataFrame: rowsCount = 3, columnsCount = 14</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"year: Int\">year</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>"] }, 
{ name: "<span title=\"quarter: Int\">quarter</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>"] }, 
{ name: "<span title=\"realgdp: Double\">realgdp</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">2710.349</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2778.801</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2775.488</span></span>"] }, 
{ name: "<span title=\"realcons: Double\">realcons</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1707.4</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1733.7</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1751.8</span></span>"] }, 
{ name: "<span title=\"realinv: Double\">realinv</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">286.898</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">310.859</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">289.226</span></span>"] }, 
{ name: "<span title=\"realgovt: Double\">realgovt</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">470.045</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">481.301</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">491.260</span></span>"] }, 
{ name: "<span title=\"realdpi: Double\">realdpi</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1886.9</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1919.7</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1916.4</span></span>"] }, 
{ name: "<span title=\"cpi: Double\">cpi</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">28.98</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">29.15</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">29.35</span></span>"] }, 
{ name: "<span title=\"m1: Double\">m1</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">139.7</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">141.7</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">140.5</span></span>"] }, 
{ name: "<span title=\"tbilrate: Double\">tbilrate</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.82</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3.08</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3.82</span></span>"] }, 
{ name: "<span title=\"unemp: Double\">unemp</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.8</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.3</span></span>"] }, 
{ name: "<span title=\"pop: Double\">pop</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">177.146</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">177.830</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">178.657</span></span>"] }, 
{ name: "<span title=\"infl: Double\">infl</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.00</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.34</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.74</span></span>"] }, 
{ name: "<span title=\"realint: Double\">realint</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.00</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.74</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.09</span></span>"] }, 
], id: 1728053268, rootId: 1728053268, totalRows: 3 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(1728053268) });


        </script>
        </html></div></div>
</div>
<p>Consider the following example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="nv">longFormat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="na">groupBy</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">quarter</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">.</span><span class="na">values</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">realgdp</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">infl</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">unemp</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">.</span><span class="na">gather</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">realgdp</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">infl</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">unemp</span><span class="w"> </span><span class="p">}.</span><span class="na">into</span><span class="p">(</span><span class="s">&quot;item&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;value&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="na">explode</span><span class="p">(</span><span class="s">&quot;value&quot;</span><span class="p">)</span>

<span class="n">longFormat</span><span class="p">.</span><span class="na">head</span><span class="p">(</span><span class="m">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_1728053269"></table>

<p class="dataframe_description">DataFrame: rowsCount = 10, columnsCount = 4</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"year: Int\">year</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>"] }, 
{ name: "<span title=\"quarter: Int\">quarter</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4</span></span>"] }, 
{ name: "<span title=\"item: String\">item</span>", children: [], rightAlign: false, values: ["realgdp","infl","unemp","realgdp","infl","unemp","realgdp","infl","unemp","realgdp"] }, 
{ name: "<span title=\"value: Double\">value</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">2710.349</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.000</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.800</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2778.801</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.340</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.100</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2775.488</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.740</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.300</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2785.204</span></span>"] }, 
], id: 1728053269, rootId: 1728053269, totalRows: 10 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(1728053269) });


        </script>
        </html></div></div>
</div>
<p>In Kotlin DataFrame, <code class="docutils literal notranslate"><span class="pre">groupBy</span></code> operation is not only used for grouping and aggregating data, but it can be very useful for rearranging data. <code class="docutils literal notranslate"><span class="pre">groupBy</span></code> takes a list of columns to group by, and produces a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> where each group key is placed in a distinct row, with its associated group (a <code class="docutils literal notranslate"><span class="pre">FrameColumn</span></code>).</p>
<p>If we run the code above row by row, we can see how the result <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> has been formed:</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Click on the grouped DataFrame to expand the content of the <code class="docutils literal notranslate"><span class="pre">FrameColumn</span></code> Object!</p>
</div>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="na">head</span><span class="p">(</span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="c1">// using head just to limit the output</span>
<span class="w">    </span><span class="p">.</span><span class="na">groupBy</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">quarter</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_1728053270"></table>

<p class="dataframe_description">GroupBy</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"year: Int\">year</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>"] }, 
{ name: "<span title=\"quarter: Int\">quarter</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4</span></span>"] }, 
{ name: "<span title=\"group: DataFrame\">group</span>", children: [], rightAlign: false, values: [{ frameId: 1728053271, value: "<b>DataFrame 1 x 14</b>" },{ frameId: 1728053272, value: "<b>DataFrame 1 x 14</b>" },{ frameId: 1728053273, value: "<b>DataFrame 1 x 14</b>" },{ frameId: 1728053274, value: "<b>DataFrame 1 x 14</b>" }] }, 
], id: 1728053270, rootId: 1728053270, totalRows: 4 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"year: Int\">year</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>"] }, 
{ name: "<span title=\"quarter: Int\">quarter</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>"] }, 
{ name: "<span title=\"realgdp: Double\">realgdp</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">2710.349</span></span>"] }, 
{ name: "<span title=\"realcons: Double\">realcons</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1707.4</span></span>"] }, 
{ name: "<span title=\"realinv: Double\">realinv</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">286.898</span></span>"] }, 
{ name: "<span title=\"realgovt: Double\">realgovt</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">470.045</span></span>"] }, 
{ name: "<span title=\"realdpi: Double\">realdpi</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1886.9</span></span>"] }, 
{ name: "<span title=\"cpi: Double\">cpi</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">28.98</span></span>"] }, 
{ name: "<span title=\"m1: Double\">m1</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">139.7</span></span>"] }, 
{ name: "<span title=\"tbilrate: Double\">tbilrate</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.82</span></span>"] }, 
{ name: "<span title=\"unemp: Double\">unemp</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.8</span></span>"] }, 
{ name: "<span title=\"pop: Double\">pop</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">177.146</span></span>"] }, 
{ name: "<span title=\"infl: Double\">infl</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.0</span></span>"] }, 
{ name: "<span title=\"realint: Double\">realint</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.0</span></span>"] }, 
], id: 1728053271, rootId: 1728053270, totalRows: 1 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"year: Int\">year</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>"] }, 
{ name: "<span title=\"quarter: Int\">quarter</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>"] }, 
{ name: "<span title=\"realgdp: Double\">realgdp</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">2778.801</span></span>"] }, 
{ name: "<span title=\"realcons: Double\">realcons</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1733.7</span></span>"] }, 
{ name: "<span title=\"realinv: Double\">realinv</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">310.859</span></span>"] }, 
{ name: "<span title=\"realgovt: Double\">realgovt</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">481.301</span></span>"] }, 
{ name: "<span title=\"realdpi: Double\">realdpi</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1919.7</span></span>"] }, 
{ name: "<span title=\"cpi: Double\">cpi</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">29.15</span></span>"] }, 
{ name: "<span title=\"m1: Double\">m1</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">141.7</span></span>"] }, 
{ name: "<span title=\"tbilrate: Double\">tbilrate</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">3.08</span></span>"] }, 
{ name: "<span title=\"unemp: Double\">unemp</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.1</span></span>"] }, 
{ name: "<span title=\"pop: Double\">pop</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">177.83</span></span>"] }, 
{ name: "<span title=\"infl: Double\">infl</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.34</span></span>"] }, 
{ name: "<span title=\"realint: Double\">realint</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.74</span></span>"] }, 
], id: 1728053272, rootId: 1728053270, totalRows: 1 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"year: Int\">year</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>"] }, 
{ name: "<span title=\"quarter: Int\">quarter</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>"] }, 
{ name: "<span title=\"realgdp: Double\">realgdp</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">2775.488</span></span>"] }, 
{ name: "<span title=\"realcons: Double\">realcons</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1751.8</span></span>"] }, 
{ name: "<span title=\"realinv: Double\">realinv</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">289.226</span></span>"] }, 
{ name: "<span title=\"realgovt: Double\">realgovt</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">491.26</span></span>"] }, 
{ name: "<span title=\"realdpi: Double\">realdpi</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1916.4</span></span>"] }, 
{ name: "<span title=\"cpi: Double\">cpi</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">29.35</span></span>"] }, 
{ name: "<span title=\"m1: Double\">m1</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">140.5</span></span>"] }, 
{ name: "<span title=\"tbilrate: Double\">tbilrate</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">3.82</span></span>"] }, 
{ name: "<span title=\"unemp: Double\">unemp</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.3</span></span>"] }, 
{ name: "<span title=\"pop: Double\">pop</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">178.657</span></span>"] }, 
{ name: "<span title=\"infl: Double\">infl</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.74</span></span>"] }, 
{ name: "<span title=\"realint: Double\">realint</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.09</span></span>"] }, 
], id: 1728053273, rootId: 1728053270, totalRows: 1 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"year: Int\">year</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>"] }, 
{ name: "<span title=\"quarter: Int\">quarter</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">4</span></span>"] }, 
{ name: "<span title=\"realgdp: Double\">realgdp</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">2785.204</span></span>"] }, 
{ name: "<span title=\"realcons: Double\">realcons</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1753.7</span></span>"] }, 
{ name: "<span title=\"realinv: Double\">realinv</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">299.356</span></span>"] }, 
{ name: "<span title=\"realgovt: Double\">realgovt</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">484.052</span></span>"] }, 
{ name: "<span title=\"realdpi: Double\">realdpi</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1931.3</span></span>"] }, 
{ name: "<span title=\"cpi: Double\">cpi</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">29.37</span></span>"] }, 
{ name: "<span title=\"m1: Double\">m1</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">140.0</span></span>"] }, 
{ name: "<span title=\"tbilrate: Double\">tbilrate</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">4.33</span></span>"] }, 
{ name: "<span title=\"unemp: Double\">unemp</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.6</span></span>"] }, 
{ name: "<span title=\"pop: Double\">pop</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">179.386</span></span>"] }, 
{ name: "<span title=\"infl: Double\">infl</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.27</span></span>"] }, 
{ name: "<span title=\"realint: Double\">realint</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">4.06</span></span>"] }, 
], id: 1728053274, rootId: 1728053270, totalRows: 1 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(1728053270) });


        </script>
        </html></div></div>
</div>
<p>On the other hand, if we call <code class="docutils literal notranslate"><span class="pre">pivot</span></code>, all the provided columns will be the column keys of the resulting <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, creating another group of columns.</p>
<p>So for example, if we want to pick only all the data from 1995 to 2000, and we want to display one column for each year, we can use the <code class="docutils literal notranslate"><span class="pre">pivot</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="na">filter</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m">1995</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">2000</span><span class="w"> </span><span class="p">}.</span><span class="na">pivot</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_1728053275"></table>

<p class="dataframe_description">Pivot</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"1995: DataFrame\">1995</span>", children: [], rightAlign: false, values: [{ frameId: 1728053276, value: "<b>DataFrame 4 x 14</b>" }] }, 
{ name: "<span title=\"1996: DataFrame\">1996</span>", children: [], rightAlign: false, values: [{ frameId: 1728053277, value: "<b>DataFrame 4 x 14</b>" }] }, 
{ name: "<span title=\"1997: DataFrame\">1997</span>", children: [], rightAlign: false, values: [{ frameId: 1728053278, value: "<b>DataFrame 4 x 14</b>" }] }, 
{ name: "<span title=\"1998: DataFrame\">1998</span>", children: [], rightAlign: false, values: [{ frameId: 1728053279, value: "<b>DataFrame 4 x 14</b>" }] }, 
{ name: "<span title=\"1999: DataFrame\">1999</span>", children: [], rightAlign: false, values: [{ frameId: 1728053280, value: "<b>DataFrame 4 x 14</b>" }] }, 
{ name: "<span title=\"2000: DataFrame\">2000</span>", children: [], rightAlign: false, values: [{ frameId: 1728053281, value: "<b>DataFrame 4 x 14</b>" }] }, 
], id: 1728053275, rootId: 1728053275, totalRows: 1 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"year: Int\">year</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1995</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1995</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1995</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1995</span></span>"] }, 
{ name: "<span title=\"quarter: Int\">quarter</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4</span></span>"] }, 
{ name: "<span title=\"realgdp: Double\">realgdp</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">9025.267</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">9044.668</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">9120.684</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">9184.275</span></span>"] }, 
{ name: "<span title=\"realcons: Double\">realcons</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">6004.3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">6053.5</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">6107.6</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">6150.6</span></span>"] }, 
{ name: "<span title=\"realinv: Double\">realinv</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1282.090</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1247.610</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1235.601</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1270.392</span></span>"] }, 
{ name: "<span title=\"realgovt: Double\">realgovt</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">715.326</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">712.492</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">707.649</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">681.081</span></span>"] }, 
{ name: "<span title=\"realdpi: Double\">realdpi</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">6616.6</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">6617.2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">6666.8</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">6706.2</span></span>"] }, 
{ name: "<span title=\"cpi: Double\">cpi</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">151.8</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">152.6</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">153.5</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">154.7</span></span>"] }, 
{ name: "<span title=\"m1: Double\">m1</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1149.3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1145.4</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1137.3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1123.5</span></span>"] }, 
{ name: "<span title=\"tbilrate: Double\">tbilrate</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.72</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.52</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.32</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.17</span></span>"] }, 
{ name: "<span title=\"unemp: Double\">unemp</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.5</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.7</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.7</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.6</span></span>"] }, 
{ name: "<span title=\"pop: Double\">pop</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">265.755</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">266.557</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">267.456</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">268.151</span></span>"] }, 
{ name: "<span title=\"infl: Double\">infl</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">3.44</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.10</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.35</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3.11</span></span>"] }, 
{ name: "<span title=\"realint: Double\">realint</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.28</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3.42</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.97</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.05</span></span>"] }, 
], id: 1728053276, rootId: 1728053275, totalRows: 4 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"year: Int\">year</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1996</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1996</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1996</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1996</span></span>"] }, 
{ name: "<span title=\"quarter: Int\">quarter</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4</span></span>"] }, 
{ name: "<span title=\"realgdp: Double\">realgdp</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">9247.188</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">9407.052</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">9488.879</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">9592.458</span></span>"] }, 
{ name: "<span title=\"realcons: Double\">realcons</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">6206.9</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">6277.1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">6314.6</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">6366.1</span></span>"] }, 
{ name: "<span title=\"realinv: Double\">realinv</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1287.128</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1353.795</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1422.059</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1418.193</span></span>"] }, 
{ name: "<span title=\"realgovt: Double\">realgovt</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">695.265</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">705.172</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">692.741</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">690.744</span></span>"] }, 
{ name: "<span title=\"realdpi: Double\">realdpi</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">6777.7</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">6850.6</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">6908.9</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">6946.8</span></span>"] }, 
{ name: "<span title=\"cpi: Double\">cpi</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">156.1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">157.0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">158.2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">159.4</span></span>"] }, 
{ name: "<span title=\"m1: Double\">m1</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1124.8</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1112.4</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1086.1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1081.5</span></span>"] }, 
{ name: "<span title=\"tbilrate: Double\">tbilrate</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">4.91</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.09</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.04</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4.99</span></span>"] }, 
{ name: "<span title=\"unemp: Double\">unemp</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.5</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.5</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.3</span></span>"] }, 
{ name: "<span title=\"pop: Double\">pop</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">268.853</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">269.667</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">270.581</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">271.360</span></span>"] }, 
{ name: "<span title=\"infl: Double\">infl</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">3.60</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.30</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3.05</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3.02</span></span>"] }, 
{ name: "<span title=\"realint: Double\">realint</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.31</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.79</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.00</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.97</span></span>"] }, 
], id: 1728053277, rootId: 1728053275, totalRows: 4 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"year: Int\">year</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1997</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1997</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1997</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1997</span></span>"] }, 
{ name: "<span title=\"quarter: Int\">quarter</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4</span></span>"] }, 
{ name: "<span title=\"realgdp: Double\">realgdp</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">9666.235</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">9809.551</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">9932.672</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">10008.874</span></span>"] }, 
{ name: "<span title=\"realcons: Double\">realcons</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">6430.2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">6456.2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">6566.0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">6641.1</span></span>"] }, 
{ name: "<span title=\"realinv: Double\">realinv</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1451.304</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1543.976</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1571.426</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1596.523</span></span>"] }, 
{ name: "<span title=\"realgovt: Double\">realgovt</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">681.445</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">693.525</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">691.261</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">690.311</span></span>"] }, 
{ name: "<span title=\"realdpi: Double\">realdpi</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">7008.9</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">7061.5</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">7142.4</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">7241.5</span></span>"] }, 
{ name: "<span title=\"cpi: Double\">cpi</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">159.9</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">160.4</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">161.5</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">162.0</span></span>"] }, 
{ name: "<span title=\"m1: Double\">m1</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1063.8</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1066.2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1065.5</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1074.4</span></span>"] }, 
{ name: "<span title=\"tbilrate: Double\">tbilrate</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.10</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.01</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.02</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.11</span></span>"] }, 
{ name: "<span title=\"unemp: Double\">unemp</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4.9</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4.7</span></span>"] }, 
{ name: "<span title=\"pop: Double\">pop</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">272.083</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">272.912</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">273.852</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">274.626</span></span>"] }, 
{ name: "<span title=\"infl: Double\">infl</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.25</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.25</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.73</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.24</span></span>"] }, 
{ name: "<span title=\"realint: Double\">realint</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">3.85</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3.76</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.29</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3.88</span></span>"] }, 
], id: 1728053278, rootId: 1728053275, totalRows: 4 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"year: Int\">year</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1998</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1998</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1998</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1998</span></span>"] }, 
{ name: "<span title=\"quarter: Int\">quarter</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4</span></span>"] }, 
{ name: "<span title=\"realgdp: Double\">realgdp</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">10103.425</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">10194.277</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">10328.787</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">10507.575</span></span>"] }, 
{ name: "<span title=\"realcons: Double\">realcons</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">6707.2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">6822.6</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">6913.1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">7019.1</span></span>"] }, 
{ name: "<span title=\"realinv: Double\">realinv</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1672.732</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1652.716</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1700.071</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1754.743</span></span>"] }, 
{ name: "<span title=\"realgovt: Double\">realgovt</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">668.783</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">687.184</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">681.472</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">688.147</span></span>"] }, 
{ name: "<span title=\"realdpi: Double\">realdpi</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">7406.2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">7512.0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">7591.0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">7646.5</span></span>"] }, 
{ name: "<span title=\"cpi: Double\">cpi</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">162.2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">163.2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">163.9</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">164.7</span></span>"] }, 
{ name: "<span title=\"m1: Double\">m1</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1076.1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1075.0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1086.0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1097.8</span></span>"] }, 
{ name: "<span title=\"tbilrate: Double\">tbilrate</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.02</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4.98</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4.49</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4.38</span></span>"] }, 
{ name: "<span title=\"unemp: Double\">unemp</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">4.6</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4.4</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4.5</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4.4</span></span>"] }, 
{ name: "<span title=\"pop: Double\">pop</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">275.304</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">276.115</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">277.003</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">277.790</span></span>"] }, 
{ name: "<span title=\"infl: Double\">infl</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.49</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.46</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.71</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.95</span></span>"] }, 
{ name: "<span title=\"realint: Double\">realint</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">4.53</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.52</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.78</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.43</span></span>"] }, 
], id: 1728053279, rootId: 1728053275, totalRows: 4 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"year: Int\">year</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1999</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1999</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1999</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1999</span></span>"] }, 
{ name: "<span title=\"quarter: Int\">quarter</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4</span></span>"] }, 
{ name: "<span title=\"realgdp: Double\">realgdp</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">10601.179</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">10684.049</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">10819.914</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">11014.254</span></span>"] }, 
{ name: "<span title=\"realcons: Double\">realcons</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">7088.3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">7199.9</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">7286.4</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">7389.2</span></span>"] }, 
{ name: "<span title=\"realinv: Double\">realinv</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1809.993</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1803.674</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1848.949</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1914.567</span></span>"] }, 
{ name: "<span title=\"realgovt: Double\">realgovt</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">683.601</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">683.594</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">697.936</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">713.445</span></span>"] }, 
{ name: "<span title=\"realdpi: Double\">realdpi</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">7698.4</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">7716.0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">7765.9</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">7887.7</span></span>"] }, 
{ name: "<span title=\"cpi: Double\">cpi</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">165.9</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">166.7</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">168.1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">169.3</span></span>"] }, 
{ name: "<span title=\"m1: Double\">m1</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1101.9</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1098.7</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1102.3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1121.9</span></span>"] }, 
{ name: "<span title=\"tbilrate: Double\">tbilrate</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">4.39</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4.54</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4.75</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.20</span></span>"] }, 
{ name: "<span title=\"unemp: Double\">unemp</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">4.3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4.3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4.2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4.1</span></span>"] }, 
{ name: "<span title=\"pop: Double\">pop</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">278.451</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">279.295</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">280.203</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">280.976</span></span>"] }, 
{ name: "<span title=\"infl: Double\">infl</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.90</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.92</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3.35</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.85</span></span>"] }, 
{ name: "<span title=\"realint: Double\">realint</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.49</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.62</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.41</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.35</span></span>"] }, 
], id: 1728053280, rootId: 1728053275, totalRows: 4 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"year: Int\">year</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">2000</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2000</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2000</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2000</span></span>"] }, 
{ name: "<span title=\"quarter: Int\">quarter</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4</span></span>"] }, 
{ name: "<span title=\"realgdp: Double\">realgdp</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">11043.044</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">11258.454</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">11267.867</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">11334.544</span></span>"] }, 
{ name: "<span title=\"realcons: Double\">realcons</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">7501.3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">7571.8</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">7645.9</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">7713.5</span></span>"] }, 
{ name: "<span title=\"realinv: Double\">realinv</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1887.836</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2018.529</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1986.956</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1987.845</span></span>"] }, 
{ name: "<span title=\"realgovt: Double\">realgovt</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">685.216</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">712.641</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">698.827</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">695.597</span></span>"] }, 
{ name: "<span title=\"realdpi: Double\">realdpi</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">8053.4</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">8135.9</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">8222.3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">8234.6</span></span>"] }, 
{ name: "<span title=\"cpi: Double\">cpi</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">170.9</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">172.7</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">173.9</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">175.6</span></span>"] }, 
{ name: "<span title=\"m1: Double\">m1</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1113.5</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1103.0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1098.7</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1097.7</span></span>"] }, 
{ name: "<span title=\"tbilrate: Double\">tbilrate</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.63</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.81</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">6.07</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">5.70</span></span>"] }, 
{ name: "<span title=\"unemp: Double\">unemp</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">4.0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3.9</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4.0</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3.9</span></span>"] }, 
{ name: "<span title=\"pop: Double\">pop</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">281.653</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">282.385</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">283.190</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">283.900</span></span>"] }, 
{ name: "<span title=\"infl: Double\">infl</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">3.76</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4.19</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.77</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3.89</span></span>"] }, 
{ name: "<span title=\"realint: Double\">realint</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.87</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.62</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3.30</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.81</span></span>"] }, 
], id: 1728053281, rootId: 1728053275, totalRows: 4 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(1728053275) });


        </script>
        </html></div></div>
</div>
<p>After a <code class="docutils literal notranslate"><span class="pre">pivot</span></code> or <code class="docutils literal notranslate"><span class="pre">groupBy</span></code> operation, we can use the method <code class="docutils literal notranslate"><span class="pre">values</span></code> for selecting only some columns of the group.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="na">head</span><span class="p">(</span><span class="m">4</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="na">groupBy</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">quarter</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">.</span><span class="na">values</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">realgdp</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">infl</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">unemp</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_1728053282"></table>

<p class="dataframe_description">DataFrame: rowsCount = 4, columnsCount = 5</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"year: Int\">year</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>"] }, 
{ name: "<span title=\"quarter: Int\">quarter</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4</span></span>"] }, 
{ name: "<span title=\"realgdp: List<Double>\">realgdp</span>", children: [], rightAlign: false, values: ["<span class=\"formatted\" title=\"2710.349\"><span class=\"structural\">[</span><span class=\"numbers\">2710.3</span><span class=\"structural\">]</span></span>","<span class=\"formatted\" title=\"2778.801\"><span class=\"structural\">[</span><span class=\"numbers\">2778.8</span><span class=\"structural\">]</span></span>","<span class=\"formatted\" title=\"2775.488\"><span class=\"structural\">[</span><span class=\"numbers\">2775.5</span><span class=\"structural\">]</span></span>","<span class=\"formatted\" title=\"2785.204\"><span class=\"structural\">[</span><span class=\"numbers\">2785.2</span><span class=\"structural\">]</span></span>"] }, 
{ name: "<span title=\"infl: List<Double>\">infl</span>", children: [], rightAlign: false, values: ["<span class=\"formatted\" title=\"0.0\"><span class=\"structural\">[</span><span class=\"numbers\">0.0</span><span class=\"structural\">]</span></span>","<span class=\"formatted\" title=\"2.34\"><span class=\"structural\">[</span><span class=\"numbers\">2.3</span><span class=\"structural\">]</span></span>","<span class=\"formatted\" title=\"2.74\"><span class=\"structural\">[</span><span class=\"numbers\">2.7</span><span class=\"structural\">]</span></span>","<span class=\"formatted\" title=\"0.27\"><span class=\"structural\">[</span><span class=\"numbers\">0.3</span><span class=\"structural\">]</span></span>"] }, 
{ name: "<span title=\"unemp: List<Double>\">unemp</span>", children: [], rightAlign: false, values: ["<span class=\"formatted\" title=\"5.8\"><span class=\"structural\">[</span><span class=\"numbers\">5.8</span><span class=\"structural\">]</span></span>","<span class=\"formatted\" title=\"5.1\"><span class=\"structural\">[</span><span class=\"numbers\">5.1</span><span class=\"structural\">]</span></span>","<span class=\"formatted\" title=\"5.3\"><span class=\"structural\">[</span><span class=\"numbers\">5.3</span><span class=\"structural\">]</span></span>","<span class=\"formatted\" title=\"5.6\"><span class=\"structural\">[</span><span class=\"numbers\">5.6</span><span class=\"structural\">]</span></span>"] }, 
], id: 1728053282, rootId: 1728053282, totalRows: 4 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(1728053282) });


        </script>
        </html></div></div>
</div>
<p>Now, if we want to display data in the so called <em>long format</em>, with each row containing the year, quarter, item name and value, we have to make item’s columns to be mapped as rows.</p>
<p>With the help of the <a class="reference external" href="https://kotlin.github.io/dataframe/gather.html"><code class="docutils literal notranslate"><span class="pre">gather</span></code></a> we can map a set of columns to two columns: “key” containing <strong>names</strong> of the original columns and “value” containing <strong>values</strong> of the original columns.</p>
<p>In a certain way, <code class="docutils literal notranslate"><span class="pre">gather</span></code> is the opposite of <code class="docutils literal notranslate"><span class="pre">pivot</span></code>, that splits rows of a dataframe and groups them horizontally into new columns.</p>
<p>If we apply <code class="docutils literal notranslate"><span class="pre">gather</span></code>, the result will be:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="na">head</span><span class="p">(</span><span class="m">4</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="na">groupBy</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">quarter</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">.</span><span class="na">values</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">realgdp</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">infl</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">unemp</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">.</span><span class="na">gather</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">realgdp</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">infl</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">unemp</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">.</span><span class="na">into</span><span class="p">(</span><span class="s">&quot;item&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;value&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_1728053283"></table>

<p class="dataframe_description">DataFrame: rowsCount = 12, columnsCount = 4</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"year: Int\">year</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1959</span></span>"] }, 
{ name: "<span title=\"quarter: Int\">quarter</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4</span></span>"] }, 
{ name: "<span title=\"item: String\">item</span>", children: [], rightAlign: false, values: ["realgdp","infl","unemp","realgdp","infl","unemp","realgdp","infl","unemp","realgdp","infl","unemp"] }, 
{ name: "<span title=\"value: List<Double>\">value</span>", children: [], rightAlign: false, values: ["<span class=\"formatted\" title=\"2710.349\"><span class=\"structural\">[</span><span class=\"numbers\">2710.3</span><span class=\"structural\">]</span></span>","<span class=\"formatted\" title=\"0.0\"><span class=\"structural\">[</span><span class=\"numbers\">0.0</span><span class=\"structural\">]</span></span>","<span class=\"formatted\" title=\"5.8\"><span class=\"structural\">[</span><span class=\"numbers\">5.8</span><span class=\"structural\">]</span></span>","<span class=\"formatted\" title=\"2778.801\"><span class=\"structural\">[</span><span class=\"numbers\">2778.8</span><span class=\"structural\">]</span></span>","<span class=\"formatted\" title=\"2.34\"><span class=\"structural\">[</span><span class=\"numbers\">2.3</span><span class=\"structural\">]</span></span>","<span class=\"formatted\" title=\"5.1\"><span class=\"structural\">[</span><span class=\"numbers\">5.1</span><span class=\"structural\">]</span></span>","<span class=\"formatted\" title=\"2775.488\"><span class=\"structural\">[</span><span class=\"numbers\">2775.5</span><span class=\"structural\">]</span></span>","<span class=\"formatted\" title=\"2.74\"><span class=\"structural\">[</span><span class=\"numbers\">2.7</span><span class=\"structural\">]</span></span>","<span class=\"formatted\" title=\"5.3\"><span class=\"structural\">[</span><span class=\"numbers\">5.3</span><span class=\"structural\">]</span></span>","<span class=\"formatted\" title=\"2785.204\"><span class=\"structural\">[</span><span class=\"numbers\">2785.2</span><span class=\"structural\">]</span></span>","<span class=\"formatted\" title=\"0.27\"><span class=\"structural\">[</span><span class=\"numbers\">0.3</span><span class=\"structural\">]</span></span>","<span class=\"formatted\" title=\"5.6\"><span class=\"structural\">[</span><span class=\"numbers\">5.6</span><span class=\"structural\">]</span></span>"] }, 
], id: 1728053283, rootId: 1728053283, totalRows: 12 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(1728053283) });


        </script>
        </html></div></div>
</div>
<p>Lastly, the square brackets suggest us that the <code class="docutils literal notranslate"><span class="pre">value</span></code> column contains a series of list, and we can flatten it with the <code class="docutils literal notranslate"><span class="pre">explode</span></code> method.</p>
<p>In contrast to Kotlin DataFrame, pandas has more “ad-hoc” methods for both pivoting and reshaping datasets.
Having the <code class="docutils literal notranslate"><span class="pre">Index</span></code> object, every <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> has the ability to easily <code class="docutils literal notranslate"><span class="pre">reindex</span></code> itself, or using the <code class="docutils literal notranslate"><span class="pre">pivot</span></code> operation to swap the order of both index and columns, specifying which will be the columns of values.
For example, in pandas the pipeline we created above could be translated as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;quarter&#39;</span><span class="p">],</span> <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;realgdp&#39;</span><span class="p">,</span> <span class="s1">&#39;infl&#39;</span><span class="p">,</span> <span class="s1">&#39;unemp&#39;</span><span class="p">])</span> \
    <span class="o">.</span><span class="n">stack</span><span class="p">()</span> \
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span> \
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span> <span class="s2">&quot;level_2&quot;</span><span class="p">:</span> <span class="s2">&quot;item&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;value&quot;</span><span class="p">})</span>
</pre></div>
</div>
<p>Where the <code class="docutils literal notranslate"><span class="pre">pivot_table</span></code> method is used to rearrange <code class="docutils literal notranslate"><span class="pre">Index</span></code> objects and value columns (it’s a more generalized version of <code class="docutils literal notranslate"><span class="pre">pivot</span></code> method).
In pandas, <code class="docutils literal notranslate"><span class="pre">stack</span></code> and <code class="docutils literal notranslate"><span class="pre">unstack</span></code> operations are very useful when collapsing several columns in one (like DataFrame’s <code class="docutils literal notranslate"><span class="pre">gather</span></code>), or when distributing data contained in one column across several (like DataFrame’s <code class="docutils literal notranslate"><span class="pre">pivot</span></code>). These operations, combined with the indices manipulations techniques (like <code class="docutils literal notranslate"><span class="pre">reset</span></code>/<code class="docutils literal notranslate"><span class="pre">set_index</span></code>, <code class="docutils literal notranslate"><span class="pre">reindex</span></code> (works also with columns)), makes pandas more powerful and more precise when it comes to data wrangling.
Moreover, pandas <code class="docutils literal notranslate"><span class="pre">Index</span></code> object can be of multiple types, for example <code class="docutils literal notranslate"><span class="pre">CategoricalIndex</span></code>, <code class="docutils literal notranslate"><span class="pre">DatetimeIndex</span></code>, <code class="docutils literal notranslate"><span class="pre">PeriodIndex</span></code>, <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code>. In this example, a <code class="docutils literal notranslate"><span class="pre">PeriodIndex</span></code> would have fit the data perfectly, because we can create a range of dates from a year and a quarter: <code class="docutils literal notranslate"><span class="pre">pd.PeriodIndex(year=df['year'],</span> <span class="pre">quarter=df['quarter'],</span> <span class="pre">name='date')</span></code>.</p>
<p>We now understand that the biggest difference between pandas and Kotlin DataFrame is the presence of an explicit Index Object that let us perform reshaping of the dataframe in a more precise way.</p>
<p>Note that the operation after <code class="docutils literal notranslate"><span class="pre">stack</span></code> are used only to recreate the example, the <code class="docutils literal notranslate"><span class="pre">Series</span></code> created with <code class="docutils literal notranslate"><span class="pre">stack</span></code> is perfectly usable as is.</p>
</section>
<section id="conclusions">
<h2>Conclusions<a class="headerlink" href="#conclusions" title="Permalink to this heading">#</a></h2>
<p>In the chapter we have explored how Kotlin DataFrame has a full support for data wrangling tasks. The differences with pandas are sometimes remarkable, and our way to compute some operations can be very different between the two platforms. Anyhow, with a little bit of practicing, a lot of what can be done in pandas can be archived with the use of Kotlin DataFrame.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "kotlin"
        },
        kernelOptions: {
            name: "kotlin",
            path: "./ch5"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'kotlin'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="intro_wrangling.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Data Wrangling</p>
      </div>
    </a>
    <a class="right-next"
       href="../ch6/intro_plotting.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Data Visualization</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#columngroup-and-framecolumn"><code class="docutils literal notranslate"><span class="pre">ColumnGroup</span></code> and <code class="docutils literal notranslate"><span class="pre">FrameColumn</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-multiple-dataframes">Working with Multiple DataFrames</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reshaping-and-pivoting">Reshaping and Pivoting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusions">Conclusions</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Stefano Furi
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>