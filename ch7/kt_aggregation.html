

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Data Grouping and Aggregation with Kotlin &#8212; Data Science with Kotlin</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ch7/kt_aggregation';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Data Analysis Examples" href="../DA_examples/DA_Introduction.html" />
    <link rel="prev" title="Data Aggregation and Group Operations" href="intro_aggregation_grouping.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../Introduction.html">
  
  
  
  
  
    <p class="title logo__title">Data Science with Kotlin</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../Introduction.html">
                    Data Science with Kotlin
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch1/Arrays%26Matrices.html">Working with Arrays and Matrices</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch1/Multik_Arrays.html">Kotlin NDArrays</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch2/Data_Manipulation.html">Data Analysis and Manipulation Tools</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch2/Intro_dataframe.html">Data handling with Dataframe</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ch3/io.html">Data Loading and Storage</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch4/Intro_DataCleaning.html">Data Cleaning and Preparation</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch4/kt_data_manipulation.html">Data Preparation with Kotlin</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch5/intro_wrangling.html">Data Wrangling</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch5/kt_wrangling.html">Data Wrangling with Kotlin</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch6/intro_plotting.html">Data Visualization</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch6/kt_plotting.html">Visualizing Data in Kotlin</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="intro_aggregation_grouping.html">Data Aggregation and Group Operations</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Data Grouping and Aggregation with Kotlin</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../DA_examples/DA_Introduction.html">Data Analysis Examples</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../DA_examples/tips_kotlin.html">Kotlin: Tips Dataset</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/S-furi/uni-internship/tree/report/report" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/S-furi/uni-internship/tree/report/report/issues/new?title=Issue%20on%20page%20%2Fch7/kt_aggregation.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/ch7/kt_aggregation.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Data Grouping and Aggregation with Kotlin</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#split">Split</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregation-apply-and-combine">Aggregation (Apply and Combine)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#apply"><code class="docutils literal notranslate"><span class="pre">apply</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pivot-tables-and-cross-tabulation">Pivot Tables and Cross Tabulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="data-grouping-and-aggregation-with-kotlin">
<h1>Data Grouping and Aggregation with Kotlin<a class="headerlink" href="#data-grouping-and-aggregation-with-kotlin" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">use</span><span class="w"> </span><span class="n">dataframe</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">            <div id="kotlin_out_0"></div>
            <script type="text/javascript">
                            if(!window.kotlinQueues) {
                window.kotlinQueues = {};
            }
            if(!window.kotlinQueues["DataFrame"]) {
                var resQueue = [];
                window.kotlinQueues["DataFrame"] = resQueue;
                window["call_DataFrame"] = function(f) {
                    resQueue.push(f);
                }
            }
            (function (){
                var modifiers = [(function(script) {
    script.src = "https://cdn.jsdelivr.net/gh/Kotlin/dataframe@3db46ccccaa1291c0627307d64133317f545e6ae/core/src/main/resources/init.js"
    script.type = "text/javascript";
})];
                var e = document.getElementById("kotlin_out_0");
                modifiers.forEach(function (gen) {
                    var script = document.createElement("script");
                    gen(script)
                    script.addEventListener("load", function() {
                        window["call_DataFrame"] = function(f) {f();};
                        window.kotlinQueues["DataFrame"].forEach(function(f) {f();});
                        window.kotlinQueues["DataFrame"] = [];
                    }, false);
                    script.addEventListener("error", function() {
                        window["call_DataFrame"] = function(f) {};
                        window.kotlinQueues["DataFrame"] = [];
                        var div = document.createElement("div");
                        div.style.color = 'darkred';
                        div.textContent = 'Error loading resource DataFrame';
                        document.getElementById("kotlin_out_0").appendChild(div);
                    }, false);
                    
                    e.appendChild(script);
                });
            })();
            </script></div><div class="output text_html">                <style>
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}


                </style></div></div>
</div>
<p>Kotlin DataFrame provides a very similar interface to the one supplied by pandas. The methods that we will use more will be <code class="docutils literal notranslate"><span class="pre">groupBy()</span></code> and <code class="docutils literal notranslate"><span class="pre">pivot()</span></code>, that we have already discussed in a previous chapter.</p>
<p>Having no such thing as <code class="docutils literal notranslate"><span class="pre">pandas.Index</span></code>, with Kotlin DataFrame the structure of the tabular data is more flexible, but in the same time it lacks all the power that a <em>labeled</em> index or multi index could give.
The tabular object represented by a Kotlin <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> is slightly different from the pandas one, and so we have to think differently sometimes when it comes to replicate some pandas behaviors, especially when pivoting and grouping by a variable.</p>
<section id="split">
<h2>Split<a class="headerlink" href="#split" title="Permalink to this heading">#</a></h2>
<p>The “Split” operation in both pandas and DataFrame, is performed when invoking the <code class="docutils literal notranslate"><span class="pre">groupBy</span></code> or <code class="docutils literal notranslate"><span class="pre">pivot</span></code> operation. The result of those methods are not a dataset, but a temporary data structure that needs an aggregate operation to combine all the groups that are been created.</p>
<p>Let’s consider the following dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="nv">rand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">util</span><span class="p">.</span><span class="na">Random</span><span class="p">(</span><span class="m">100</span><span class="p">)</span>
<span class="kd">val</span><span class="w"> </span><span class="nv">letters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sequenceOf</span><span class="p">(</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;B&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;C&quot;</span><span class="p">)</span>

<span class="kd">val</span><span class="w"> </span><span class="nv">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mapOf</span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;letter&quot;</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">List</span><span class="p">(</span><span class="m">10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">letters</span><span class="p">.</span><span class="na">shuffled</span><span class="p">().</span><span class="na">find</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="s">&quot;num&quot;</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">List</span><span class="p">(</span><span class="m">10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">rand</span><span class="p">.</span><span class="na">nextGaussian</span><span class="p">()</span><span class="w"> </span><span class="p">}</span>
<span class="p">).</span><span class="na">toDataFrame</span><span class="p">()</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_469762048"></table>

<p class="dataframe_description">DataFrame: rowsCount = 10, columnsCount = 2</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"letter: String\">letter</span>", children: [], rightAlign: false, values: ["B","A","C","B","A","B","A","B","A","B"] }, 
{ name: "<span title=\"num: Double\">num</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.624629</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-0.858192</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.676221</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.126394</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.437662</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.492079</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-1.598537</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-0.077561</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.991766</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.270969</span></span>"] }, 
], id: 469762048, rootId: 469762048, totalRows: 10 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(469762048) });


        </script>
        </html></div></div>
</div>
<p>If we call a <a class="reference external" href="https://kotlin.github.io/dataframe/groupby.html"><code class="docutils literal notranslate"><span class="pre">groupBy</span></code></a> with the <code class="docutils literal notranslate"><span class="pre">letter</span></code> column, we will <em>split</em> the dataset into three groups, one for each letter. In Kotlin DataFrame, we can print easily the content of the grouping operation, whereas in python we have to loop through the content of each group, because calling <code class="docutils literal notranslate"><span class="pre">groupby</span></code> will not compute anything except some intermediate data about the group key.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="na">groupBy</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">letter</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_469762049"></table>

<p class="dataframe_description">GroupBy</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"letter: String\">letter</span>", children: [], rightAlign: false, values: ["B","A","C"] }, 
{ name: "<span title=\"group: DataFrame\">group</span>", children: [], rightAlign: false, values: [{ frameId: 469762050, value: "<b>DataFrame 5 x 2</b>" },{ frameId: 469762051, value: "<b>DataFrame 4 x 2</b>" },{ frameId: 469762052, value: "<b>DataFrame 1 x 2</b>" }] }, 
], id: 469762049, rootId: 469762049, totalRows: 3 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"letter: String\">letter</span>", children: [], rightAlign: false, values: ["B","B","B","B","B"] }, 
{ name: "<span title=\"num: Double\">num</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.624629</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.126394</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.492079</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-0.077561</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.270969</span></span>"] }, 
], id: 469762050, rootId: 469762049, totalRows: 5 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"letter: String\">letter</span>", children: [], rightAlign: false, values: ["A","A","A","A"] }, 
{ name: "<span title=\"num: Double\">num</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">-0.858192</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.437662</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-1.598537</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.991766</span></span>"] }, 
], id: 469762051, rootId: 469762049, totalRows: 4 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"letter: String\">letter</span>", children: [], rightAlign: false, values: ["C"] }, 
{ name: "<span title=\"num: Double\">num</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.676221</span></span>"] }, 
], id: 469762052, rootId: 469762049, totalRows: 1 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(469762049) });


        </script>
        </html></div></div>
</div>
<p>And we can see all the groups that are being formed.
The <code class="docutils literal notranslate"><span class="pre">groupBy</span></code> method accept any column expression provided, so the following will be still legit:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="na">groupBy</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">letter</span><span class="p">.</span><span class="na">map</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;A&quot;</span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_469762053"></table>

<p class="dataframe_description">GroupBy</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"letter: Boolean\">letter</span>", children: [], rightAlign: false, values: ["false","true"] }, 
{ name: "<span title=\"group: DataFrame\">group</span>", children: [], rightAlign: false, values: [{ frameId: 469762054, value: "<b>DataFrame 6 x 2</b>" },{ frameId: 469762055, value: "<b>DataFrame 4 x 2</b>" }] }, 
], id: 469762053, rootId: 469762053, totalRows: 2 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"letter: String\">letter</span>", children: [], rightAlign: false, values: ["B","C","B","B","B"] }, 
{ name: "<span title=\"num: Double\">num</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.624629</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.676221</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.126394</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.492079</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-0.077561</span></span>"] }, 
], id: 469762054, rootId: 469762053, totalRows: 6 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"letter: String\">letter</span>", children: [], rightAlign: false, values: ["A","A","A","A"] }, 
{ name: "<span title=\"num: Double\">num</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">-0.858192</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.437662</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-1.598537</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.991766</span></span>"] }, 
], id: 469762055, rootId: 469762053, totalRows: 4 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(469762053) });


        </script>
        </html></div></div>
</div>
<p>This is very useful when manipulating <code class="docutils literal notranslate"><span class="pre">date</span></code> objects and we want to group by year/month/day.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="nv">dates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">listOf</span><span class="p">(</span>
<span class="w">    </span><span class="n">LocalDate</span><span class="p">(</span><span class="m">1998</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">),</span>
<span class="w">    </span><span class="n">LocalDate</span><span class="p">(</span><span class="m">1999</span><span class="p">,</span><span class="w"> </span><span class="m">11</span><span class="p">,</span><span class="w"> </span><span class="m">21</span><span class="p">),</span>
<span class="w">    </span><span class="n">LocalDate</span><span class="p">(</span><span class="m">1999</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">12</span><span class="p">),</span>
<span class="w">    </span><span class="n">LocalDate</span><span class="p">(</span><span class="m">1998</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">22</span><span class="p">),</span>
<span class="w">    </span><span class="n">LocalDate</span><span class="p">(</span><span class="m">1998</span><span class="p">,</span><span class="w"> </span><span class="m">12</span><span class="p">,</span><span class="w"> </span><span class="m">25</span><span class="p">),</span>
<span class="w">    </span><span class="n">LocalDate</span><span class="p">(</span><span class="m">1999</span><span class="p">,</span><span class="w"> </span><span class="m">12</span><span class="p">,</span><span class="w"> </span><span class="m">24</span><span class="p">),</span>
<span class="w">    </span><span class="n">LocalDate</span><span class="p">(</span><span class="m">1999</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">9</span><span class="p">),</span>
<span class="w">    </span><span class="n">LocalDate</span><span class="p">(</span><span class="m">1999</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">24</span><span class="p">),</span>
<span class="w">    </span><span class="n">LocalDate</span><span class="p">(</span><span class="m">1998</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">20</span><span class="p">),</span>
<span class="w">    </span><span class="n">LocalDate</span><span class="p">(</span><span class="m">1999</span><span class="p">,</span><span class="w"> </span><span class="m">12</span><span class="p">,</span><span class="w"> </span><span class="m">20</span><span class="p">),</span>
<span class="p">).</span><span class="na">toColumn</span><span class="p">(</span><span class="s">&quot;date&quot;</span><span class="p">)</span>

<span class="kd">val</span><span class="w"> </span><span class="nv">dfd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">dfd</span><span class="p">.</span><span class="na">groupBy</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">date</span><span class="p">.</span><span class="na">map</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="p">.</span><span class="na">year</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_469762056"></table>

<p class="dataframe_description">GroupBy</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"date: Int\">date</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1998</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1999</span></span>"] }, 
{ name: "<span title=\"group: DataFrame\">group</span>", children: [], rightAlign: false, values: [{ frameId: 469762057, value: "<b>DataFrame 4 x 3</b>" },{ frameId: 469762058, value: "<b>DataFrame 6 x 3</b>" }] }, 
], id: 469762056, rootId: 469762056, totalRows: 2 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"letter: String\">letter</span>", children: [], rightAlign: false, values: ["B","B","A","A"] }, 
{ name: "<span title=\"num: Double\">num</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.624629</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.126394</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.437662</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.991766</span></span>"] }, 
{ name: "<span title=\"date: kotlinx.datetime.LocalDate\">date</span>", children: [], rightAlign: false, values: ["1998-01-02","1998-06-22","1998-12-25","1998-01-20"] }, 
], id: 469762057, rootId: 469762056, totalRows: 4 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"letter: String\">letter</span>", children: [], rightAlign: false, values: ["A","C","B","A","B"] }, 
{ name: "<span title=\"num: Double\">num</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">-0.858192</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.676221</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.492079</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-1.598537</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-0.077561</span></span>"] }, 
{ name: "<span title=\"date: kotlinx.datetime.LocalDate\">date</span>", children: [], rightAlign: false, values: ["1999-11-21","1999-03-12","1999-12-24","1999-02-09","1999-06-24"] }, 
], id: 469762058, rootId: 469762056, totalRows: 6 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(469762056) });


        </script>
        </html></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">groupBy</span></code> accepts any number of column names to group by with.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">dfd</span><span class="p">.</span><span class="na">groupBy</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">letter</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">date</span><span class="p">.</span><span class="na">map</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="p">.</span><span class="na">year</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_469762059"></table>

<p class="dataframe_description">GroupBy</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"letter: String\">letter</span>", children: [], rightAlign: false, values: ["B","A","C","A","B"] }, 
{ name: "<span title=\"date: Int\">date</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1998</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1999</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1999</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1998</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1999</span></span>"] }, 
{ name: "<span title=\"group: DataFrame\">group</span>", children: [], rightAlign: false, values: [{ frameId: 469762060, value: "<b>DataFrame 2 x 3</b>" },{ frameId: 469762061, value: "<b>DataFrame 2 x 3</b>" },{ frameId: 469762062, value: "<b>DataFrame 1 x 3</b>" },{ frameId: 469762063, value: "<b>DataFrame 2 x 3</b>" },{ frameId: 469762064, value: "<b>DataFrame 3 x 3</b>" }] }, 
], id: 469762059, rootId: 469762059, totalRows: 5 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"letter: String\">letter</span>", children: [], rightAlign: false, values: ["B","B"] }, 
{ name: "<span title=\"num: Double\">num</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.624629</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.126394</span></span>"] }, 
{ name: "<span title=\"date: kotlinx.datetime.LocalDate\">date</span>", children: [], rightAlign: false, values: ["1998-01-02","1998-06-22"] }, 
], id: 469762060, rootId: 469762059, totalRows: 2 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"letter: String\">letter</span>", children: [], rightAlign: false, values: ["A","A"] }, 
{ name: "<span title=\"num: Double\">num</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">-0.858192</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-1.598537</span></span>"] }, 
{ name: "<span title=\"date: kotlinx.datetime.LocalDate\">date</span>", children: [], rightAlign: false, values: ["1999-11-21","1999-02-09"] }, 
], id: 469762061, rootId: 469762059, totalRows: 2 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"letter: String\">letter</span>", children: [], rightAlign: false, values: ["C"] }, 
{ name: "<span title=\"num: Double\">num</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.676221</span></span>"] }, 
{ name: "<span title=\"date: kotlinx.datetime.LocalDate\">date</span>", children: [], rightAlign: false, values: ["1999-03-12"] }, 
], id: 469762062, rootId: 469762059, totalRows: 1 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"letter: String\">letter</span>", children: [], rightAlign: false, values: ["A","A"] }, 
{ name: "<span title=\"num: Double\">num</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.437662</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.991766</span></span>"] }, 
{ name: "<span title=\"date: kotlinx.datetime.LocalDate\">date</span>", children: [], rightAlign: false, values: ["1998-12-25","1998-01-20"] }, 
], id: 469762063, rootId: 469762059, totalRows: 2 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"letter: String\">letter</span>", children: [], rightAlign: false, values: ["B","B","B"] }, 
{ name: "<span title=\"num: Double\">num</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.492079</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-0.077561</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.270969</span></span>"] }, 
{ name: "<span title=\"date: kotlinx.datetime.LocalDate\">date</span>", children: [], rightAlign: false, values: ["1999-12-24","1999-06-24","1999-12-20"] }, 
], id: 469762064, rootId: 469762059, totalRows: 3 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(469762059) });


        </script>
        </html></div></div>
</div>
<p>We can also override the name of the group key column in the resulting dataframe using the <code class="docutils literal notranslate"><span class="pre">named</span></code> keyword.</p>
<p>Before computing aggregation or reduction operations, we can apply some <strong>transformation</strong> to the groups, like sorting, or computing other groups modifications operations. Among those methods, there’s the <code class="docutils literal notranslate"><span class="pre">concat</span></code> method, that unions all data groups of <code class="docutils literal notranslate"><span class="pre">groupBy</span></code> into original <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> preserving new order of rows produced by grouping.</p>
<p>A very common pattern, is to use the concatenation of <code class="docutils literal notranslate"><span class="pre">groupBy</span></code> and <code class="docutils literal notranslate"><span class="pre">pivot</span></code> operations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">dfd</span><span class="p">.</span><span class="na">groupBy</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">date</span><span class="p">.</span><span class="na">map</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="p">.</span><span class="na">year</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="n">named</span><span class="w"> </span><span class="s">&quot;year&quot;</span><span class="w"> </span><span class="p">}.</span><span class="na">pivot</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">letter</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_469762065"></table>

<p class="dataframe_description">PivotGroupBy</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"year: Int\">year</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1998</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1999</span></span>"] }, 
{ name: "<span title=\"B: DataFrame\">B</span>", children: [], rightAlign: false, values: [{ frameId: 469762066, value: "<b>DataFrame 2 x 3</b>" },{ frameId: 469762067, value: "<b>DataFrame 3 x 3</b>" }] }, 
{ name: "<span title=\"A: DataFrame\">A</span>", children: [], rightAlign: false, values: [{ frameId: 469762068, value: "<b>DataFrame 2 x 3</b>" },{ frameId: 469762069, value: "<b>DataFrame 2 x 3</b>" }] }, 
{ name: "<span title=\"C: DataFrame\">C</span>", children: [], rightAlign: false, values: ["",{ frameId: 469762070, value: "<b>DataFrame 1 x 3</b>" }] }, 
{ name: "<span title=\"letter: DataRow\">letter</span>", children: [1, 2, 3], rightAlign: false, values: ["<span class=\"formatted\" title=\"B:    letter      num       date\n 0      B 0.624629 1998-01-02\n 1      B 1.126394 1998-06-22\n\nA:    letter      num       date\n 0      A 1.437662 1998-12-25\n 1      A 1.991766 1998-01-20\n\nC:  \n\"><span class=\"structural\">{ </span><span class=\"structural\">B: </span><span class=\"dataFrameCaption\">DataFrame [2 x 3]</span><span class=\"structural\">, </span><span class=\"structural\">A: </span><span class=\"dataFrameCaption\">Da<span class=\"structural\">...</span></span><span class=\"structural\">, </span><span class=\"structural\">C...</span><span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"B:    letter       num       date\n 0      B  1.492079 1999-12-24\n 1      B -0.077561 1999-06-24\n 2      B  0.270969 1999-12-20\n\nA:    letter       num       date\n 0      A -0.858192 1999-11-21\n 1      A -1.598537 1999-02-09\n\nC:    letter      num       date\n 0      C 0.676221 1999-03-12\n\"><span class=\"structural\">{ </span><span class=\"structural\">B: </span><span class=\"dataFrameCaption\">DataFrame [3 x 3]</span><span class=\"structural\">, </span><span class=\"structural\">A: </span><span class=\"dataFrameCaption\">Da<span class=\"structural\">...</span></span><span class=\"structural\">, </span><span class=\"structural\">C...</span><span class=\"structural\"> }</span></span>"] }, 
], id: 469762065, rootId: 469762065, totalRows: 2 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"letter: String\">letter</span>", children: [], rightAlign: false, values: ["B","B"] }, 
{ name: "<span title=\"num: Double\">num</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.624629</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.126394</span></span>"] }, 
{ name: "<span title=\"date: kotlinx.datetime.LocalDate\">date</span>", children: [], rightAlign: false, values: ["1998-01-02","1998-06-22"] }, 
], id: 469762066, rootId: 469762065, totalRows: 2 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"letter: String\">letter</span>", children: [], rightAlign: false, values: ["B","B","B"] }, 
{ name: "<span title=\"num: Double\">num</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.492079</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-0.077561</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.270969</span></span>"] }, 
{ name: "<span title=\"date: kotlinx.datetime.LocalDate\">date</span>", children: [], rightAlign: false, values: ["1999-12-24","1999-06-24","1999-12-20"] }, 
], id: 469762067, rootId: 469762065, totalRows: 3 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"letter: String\">letter</span>", children: [], rightAlign: false, values: ["A","A"] }, 
{ name: "<span title=\"num: Double\">num</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.437662</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.991766</span></span>"] }, 
{ name: "<span title=\"date: kotlinx.datetime.LocalDate\">date</span>", children: [], rightAlign: false, values: ["1998-12-25","1998-01-20"] }, 
], id: 469762068, rootId: 469762065, totalRows: 2 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"letter: String\">letter</span>", children: [], rightAlign: false, values: ["A","A"] }, 
{ name: "<span title=\"num: Double\">num</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">-0.858192</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-1.598537</span></span>"] }, 
{ name: "<span title=\"date: kotlinx.datetime.LocalDate\">date</span>", children: [], rightAlign: false, values: ["1999-11-21","1999-02-09"] }, 
], id: 469762069, rootId: 469762065, totalRows: 2 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"letter: String\">letter</span>", children: [], rightAlign: false, values: ["C"] }, 
{ name: "<span title=\"num: Double\">num</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.676221</span></span>"] }, 
{ name: "<span title=\"date: kotlinx.datetime.LocalDate\">date</span>", children: [], rightAlign: false, values: ["1999-03-12"] }, 
], id: 469762070, rootId: 469762065, totalRows: 1 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(469762065) });


        </script>
        </html></div></div>
</div>
<p>The result we have computed are not directly usable: as said before, the split-apply-combine strategy require that grouped data are aggregated and reduced with an application of a combining operation.</p>
</section>
<section id="aggregation-apply-and-combine">
<h2>Aggregation (Apply and Combine)<a class="headerlink" href="#aggregation-apply-and-combine" title="Permalink to this heading">#</a></h2>
<p>With grouped data, we can compute a large variety of operations on groups. The most common operations are defined in Kotlin DataFrame library, like <code class="docutils literal notranslate"><span class="pre">mean()</span></code>, <code class="docutils literal notranslate"><span class="pre">sum()</span></code> or <code class="docutils literal notranslate"><span class="pre">count()</span></code>.</p>
<p>For example, if we take the dataframe we grouped above, we can compute the mean of the values inside each group:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="nv">groupedDf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfd</span><span class="p">.</span><span class="na">groupBy</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">date</span><span class="p">.</span><span class="na">map</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="p">.</span><span class="na">year</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="n">named</span><span class="w"> </span><span class="s">&quot;year&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">.</span><span class="na">pivot</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">letter</span><span class="w"> </span><span class="p">}</span>

<span class="n">groupedDf</span><span class="p">.</span><span class="na">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_469762071"></table>

<p class="dataframe_description">DataFrame: rowsCount = 2, columnsCount = 2</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"year: Int\">year</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1998</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1999</span></span>"] }, 
{ name: "<span title=\"B: Double\">B</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.875512</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.561829</span></span>"] }, 
{ name: "<span title=\"A: Double\">A</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.714714</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-1.228365</span></span>"] }, 
{ name: "<span title=\"C: Double?\">C</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.676221</span></span>"] }, 
{ name: "<span title=\"letter: DataRow\">letter</span>", children: [1, 2, 3], rightAlign: false, values: ["<span class=\"formatted\" title=\"B: 0.8755115227315645\nA: 1.7147142958357764\"><span class=\"structural\">{ </span><span class=\"structural\">B: </span><span class=\"numbers\">0.9</span><span class=\"structural\">, </span><span class=\"structural\">A: </span><span class=\"numbers\">1.7</span><span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"B: 0.5618288498522336\nA: -1.2283646350577737\nC: 0.6762208162903859\"><span class=\"structural\">{ </span><span class=\"structural\">B: </span><span class=\"numbers\">0.6</span><span class=\"structural\">, </span><span class=\"structural\">A: </span><span class=\"numbers\">-1.2</span><span class=\"structural\">, </span><span class=\"structural\">C: </span><span class=\"numbers\">0.7</span><span class=\"structural\"> }</span></span>"] }, 
], id: 469762071, rootId: 469762071, totalRows: 2 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(469762071) });


        </script>
        </html></div></div>
</div>
<p>The same exact result can be archived in python with a very similar instruction:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dfd</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;letter&#39;</span><span class="p">])</span>\
    <span class="o">.</span><span class="n">mean</span><span class="p">()</span> \
    <span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;letter&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">unstack</span></code> operation is used to move “letters” from the <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code> object created with “year”, to columns. It is also possible to call <code class="docutils literal notranslate"><span class="pre">pivot_table</span></code> instead of <code class="docutils literal notranslate"><span class="pre">unstack</span></code>, specifying what will be in place of indices, columns keys and values.</p>
<p>Sometimes is useful to flatten the group result, in favor of a better handling of indices. We can use <code class="docutils literal notranslate"><span class="pre">flatten()</span></code>, which affects <em>every</em> groups of the dataframe, or <code class="docutils literal notranslate"><span class="pre">ungroup()</span></code> for selecting only one group.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">groupedDf</span><span class="p">.</span><span class="na">mean</span><span class="p">().</span><span class="na">ungroup</span><span class="p">(</span><span class="s">&quot;letter&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_469762072"></table>

<p class="dataframe_description">DataFrame: rowsCount = 2, columnsCount = 4</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"year: Int\">year</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1998</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1999</span></span>"] }, 
{ name: "<span title=\"B: Double\">B</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.875512</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.561829</span></span>"] }, 
{ name: "<span title=\"A: Double\">A</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.714714</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-1.228365</span></span>"] }, 
{ name: "<span title=\"C: Double?\">C</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.676221</span></span>"] }, 
], id: 469762072, rootId: 469762072, totalRows: 2 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(469762072) });


        </script>
        </html></div></div>
</div>
<p>Every time that we create a <code class="docutils literal notranslate"><span class="pre">GroupBy</span></code> or <code class="docutils literal notranslate"><span class="pre">Pivot</span></code> object, and after applying the needed transformations, we can aggregate or reduce all data with several functions all computed in the same time, inside the <code class="docutils literal notranslate"><span class="pre">aggregate</span></code> function. Each operation can then be mapped in the corresponding column.</p>
<p>If we want to compute the sum, the mean and the number of rows of each group, we can write:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">groupedDf</span><span class="p">.</span><span class="na">aggregate</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">        </span><span class="n">sum</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="s">&quot;sum&quot;</span>
<span class="w">        </span><span class="n">mean</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="s">&quot;mean&quot;</span>
<span class="w">        </span><span class="n">count</span><span class="p">()</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="s">&quot;count&quot;</span>
<span class="w">    </span><span class="p">}.</span><span class="na">ungroup</span><span class="p">(</span><span class="s">&quot;letter&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_469762073"></table>

<p class="dataframe_description">DataFrame: rowsCount = 2, columnsCount = 4</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"year: Int\">year</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1998</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1999</span></span>"] }, 
{ name: "<span title=\"sum: Double\">sum</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.751023</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.685487</span></span>"] }, 
{ name: "<span title=\"mean: Double\">mean</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.875512</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.561829</span></span>"] }, 
{ name: "<span title=\"count: Int\">count</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>"] }, 
{ name: "<span title=\"B: DataRow\">B</span>", children: [1, 2, 3], rightAlign: false, values: ["<span class=\"formatted\" title=\"sum: 1.751023045463129\nmean: 0.8755115227315645\ncount: 2\"><span class=\"structural\">{ </span><span class=\"structural\">sum: </span><span class=\"numbers\">1.8</span><span class=\"structural\">, </span><span class=\"structural\">mean: </span><span class=\"numbers\">0.9</span><span class=\"structural\">, </span><span class=\"structural\">count: </span><span class=\"numbers\">2</span><span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"sum: 1.6854865495567006\nmean: 0.5618288498522336\ncount: 3\"><span class=\"structural\">{ </span><span class=\"structural\">sum: </span><span class=\"numbers\">1.7</span><span class=\"structural\">, </span><span class=\"structural\">mean: </span><span class=\"numbers\">0.6</span><span class=\"structural\">, </span><span class=\"structural\">count: </span><span class=\"numbers\">3</span><span class=\"structural\"> }</span></span>"] }, 
{ name: "<span title=\"sum: Double\">sum</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">3.429429</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-2.456729</span></span>"] }, 
{ name: "<span title=\"mean: Double\">mean</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.714714</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-1.228365</span></span>"] }, 
{ name: "<span title=\"count: Int\">count</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>"] }, 
{ name: "<span title=\"A: DataRow\">A</span>", children: [5, 6, 7], rightAlign: false, values: ["<span class=\"formatted\" title=\"sum: 3.429428591671553\nmean: 1.7147142958357764\ncount: 2\"><span class=\"structural\">{ </span><span class=\"structural\">sum: </span><span class=\"numbers\">3.4</span><span class=\"structural\">, </span><span class=\"structural\">mean: </span><span class=\"numbers\">1.7</span><span class=\"structural\">, </span><span class=\"structural\">count: </span><span class=\"numbers\">2</span><span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"sum: -2.4567292701155474\nmean: -1.2283646350577737\ncount: 2\"><span class=\"structural\">{ </span><span class=\"structural\">sum: </span><span class=\"numbers\">-2.5</span><span class=\"structural\">, </span><span class=\"structural\">mean: </span><span class=\"numbers\">-1.2</span><span class=\"structural\">, </span><span class=\"structural\">count: </span><span class=\"numbers\">2</span><span class=\"structural\"> }</span></span>"] }, 
{ name: "<span title=\"sum: Double?\">sum</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.676221</span></span>"] }, 
{ name: "<span title=\"mean: Double?\">mean</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.676221</span></span>"] }, 
{ name: "<span title=\"count: Int?\">count</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1</span></span>"] }, 
{ name: "<span title=\"C: DataRow\">C</span>", children: [9, 10, 11], rightAlign: false, values: ["<span class=\"formatted\" title=\"\"><span class=\"null\">{ }</span></span>","<span class=\"formatted\" title=\"sum: 0.6762208162903859\nmean: 0.6762208162903859\ncount: 1\"><span class=\"structural\">{ </span><span class=\"structural\">sum: </span><span class=\"numbers\">0.7</span><span class=\"structural\">, </span><span class=\"structural\">mean: </span><span class=\"numbers\">0.7</span><span class=\"structural\">, </span><span class=\"structural\">count: </span><span class=\"numbers\">1</span><span class=\"structural\"> }</span></span>"] }, 
], id: 469762073, rootId: 469762073, totalRows: 2 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(469762073) });


        </script>
        </html></div></div>
</div>
<p>And this approach can be more straightforward than pandas use of <code class="docutils literal notranslate"><span class="pre">agg</span></code> function. If we consider the example above, a similar behavior can be computed in python as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;letter&#39;</span><span class="p">])</span> \
    <span class="o">.</span><span class="n">agg</span><span class="p">([(</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">)])</span> \
    <span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;letter&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Where inside <code class="docutils literal notranslate"><span class="pre">agg</span></code> function, we specify the name of the column and the function we want to apply.</p>
<p>Both in python and Kotin, inside the aggregation function a custom function can be called. For example let’s consider this function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="kd">fun</span><span class="w"> </span><span class="nf">peakToPeak</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">Double</span><span class="o">&gt;</span><span class="p">):</span><span class="w"> </span><span class="kt">Double</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">arr</span><span class="p">.</span><span class="na">max</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">arr</span><span class="p">.</span><span class="na">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>We can the call the function inside the aggregation method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">groupedDf</span><span class="p">.</span><span class="na">aggregate</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">peakToPeak</span><span class="p">(</span><span class="n">num</span><span class="p">.</span><span class="na">toList</span><span class="p">())</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_469762074"></table>

<p class="dataframe_description">DataFrame: rowsCount = 2, columnsCount = 2</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"year: Int\">year</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1998</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1999</span></span>"] }, 
{ name: "<span title=\"B: Double\">B</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.501765</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.569640</span></span>"] }, 
{ name: "<span title=\"A: Double\">A</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.554104</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.740346</span></span>"] }, 
{ name: "<span title=\"C: Double?\">C</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.0</span></span>"] }, 
{ name: "<span title=\"letter: DataRow\">letter</span>", children: [1, 2, 3], rightAlign: false, values: ["<span class=\"formatted\" title=\"B: 0.5017646071887769\nA: 0.5541041929100174\"><span class=\"structural\">{ </span><span class=\"structural\">B: </span><span class=\"numbers\">0.5</span><span class=\"structural\">, </span><span class=\"structural\">A: </span><span class=\"numbers\">0.6</span><span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"B: 1.5696399986487743\nA: 0.7403456539390477\nC: 0.0\"><span class=\"structural\">{ </span><span class=\"structural\">B: </span><span class=\"numbers\">1.6</span><span class=\"structural\">, </span><span class=\"structural\">A: </span><span class=\"numbers\">0.7</span><span class=\"structural\">, </span><span class=\"structural\">C: </span><span class=\"numbers\">0.0</span><span class=\"structural\"> }</span></span>"] }, 
], id: 469762074, rootId: 469762074, totalRows: 2 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(469762074) });


        </script>
        </html></div></div>
</div>
<p>And the same thing can be done with pandas <code class="docutils literal notranslate"><span class="pre">agg</span></code> easily with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">peak_to_peak</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">arr</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">arr</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

<span class="n">groupedDf</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">peak_to_peak</span><span class="p">)</span>
</pre></div>
</div>
<p>Kotlin DataFrame is very similar in behavior with pandas, and the transition between the two platform is very natural because of the same strategies implementations.</p>
<section id="apply">
<h3><code class="docutils literal notranslate"><span class="pre">apply</span></code><a class="headerlink" href="#apply" title="Permalink to this heading">#</a></h3>
<p>In python, the <code class="docutils literal notranslate"><span class="pre">agg</span></code> function performs row-wise operations, whereas the <code class="docutils literal notranslate"><span class="pre">apply</span></code> function is a more general purpose. In Kotlin we are more limited with the use of <code class="docutils literal notranslate"><span class="pre">aggregate</span></code>, but with some turnarounds, we can stille get the same results, effortlessly.</p>
<p>Consider this python function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">top</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">column</span><span class="p">)[</span><span class="o">-</span><span class="n">n</span><span class="p">:]</span>
</pre></div>
</div>
<p>That returns the top <code class="docutils literal notranslate"><span class="pre">n</span></code> rows with the largest value in <code class="docutils literal notranslate"><span class="pre">column</span></code>.</p>
<p>With <code class="docutils literal notranslate"><span class="pre">apply</span></code>, we can call this operation to every group:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="s1">&#39;letter&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;num&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>and the “dataframe” operation is computed along each groups.</p>
<p>The same behavior can be accomplished in kotlin with:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="kd">fun</span><span class="w"> </span><span class="nf">top</span><span class="p">(</span><span class="n">df</span><span class="p">:</span><span class="w"> </span><span class="n">AnyFrame</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">):</span><span class="w"> </span><span class="n">AnyFrame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="na">sortByDesc</span><span class="p">(</span><span class="n">col</span><span class="p">).</span><span class="na">head</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">groupedDf</span><span class="p">.</span><span class="na">aggregate</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">top</span><span class="p">(</span><span class="nb">it</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;num&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="m">5</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_469762075"></table>

<p class="dataframe_description">DataFrame: rowsCount = 2, columnsCount = 2</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"year: Int\">year</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1998</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1999</span></span>"] }, 
{ name: "<span title=\"B: DataFrame\">B</span>", children: [], rightAlign: false, values: [{ frameId: 469762076, value: "<b>DataFrame 2 x 3</b>" },{ frameId: 469762077, value: "<b>DataFrame 3 x 3</b>" }] }, 
{ name: "<span title=\"A: DataFrame\">A</span>", children: [], rightAlign: false, values: [{ frameId: 469762078, value: "<b>DataFrame 2 x 3</b>" },{ frameId: 469762079, value: "<b>DataFrame 2 x 3</b>" }] }, 
{ name: "<span title=\"C: DataFrame\">C</span>", children: [], rightAlign: false, values: ["",{ frameId: 469762080, value: "<b>DataFrame 1 x 3</b>" }] }, 
{ name: "<span title=\"letter: DataRow\">letter</span>", children: [1, 2, 3], rightAlign: false, values: ["<span class=\"formatted\" title=\"B:    letter      num       date\n 0      B 1.126394 1998-06-22\n 1      B 0.624629 1998-01-02\n\nA:    letter      num       date\n 0      A 1.991766 1998-01-20\n 1      A 1.437662 1998-12-25\n\nC:  \n\"><span class=\"structural\">{ </span><span class=\"structural\">B: </span><span class=\"dataFrameCaption\">DataFrame [2 x 3]</span><span class=\"structural\">, </span><span class=\"structural\">A: </span><span class=\"dataFrameCaption\">Da<span class=\"structural\">...</span></span><span class=\"structural\">, </span><span class=\"structural\">C...</span><span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"B:    letter       num       date\n 0      B  1.492079 1999-12-24\n 1      B  0.270969 1999-12-20\n 2      B -0.077561 1999-06-24\n\nA:    letter       num       date\n 0      A -0.858192 1999-11-21\n 1      A -1.598537 1999-02-09\n\nC:    letter      num       date\n 0      C 0.676221 1999-03-12\n\"><span class=\"structural\">{ </span><span class=\"structural\">B: </span><span class=\"dataFrameCaption\">DataFrame [3 x 3]</span><span class=\"structural\">, </span><span class=\"structural\">A: </span><span class=\"dataFrameCaption\">Da<span class=\"structural\">...</span></span><span class=\"structural\">, </span><span class=\"structural\">C...</span><span class=\"structural\"> }</span></span>"] }, 
], id: 469762075, rootId: 469762075, totalRows: 2 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"letter: String\">letter</span>", children: [], rightAlign: false, values: ["B","B"] }, 
{ name: "<span title=\"num: Double\">num</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.126394</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.624629</span></span>"] }, 
{ name: "<span title=\"date: kotlinx.datetime.LocalDate\">date</span>", children: [], rightAlign: false, values: ["1998-06-22","1998-01-02"] }, 
], id: 469762076, rootId: 469762075, totalRows: 2 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"letter: String\">letter</span>", children: [], rightAlign: false, values: ["B","B","B"] }, 
{ name: "<span title=\"num: Double\">num</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.492079</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.270969</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-0.077561</span></span>"] }, 
{ name: "<span title=\"date: kotlinx.datetime.LocalDate\">date</span>", children: [], rightAlign: false, values: ["1999-12-24","1999-12-20","1999-06-24"] }, 
], id: 469762077, rootId: 469762075, totalRows: 3 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"letter: String\">letter</span>", children: [], rightAlign: false, values: ["A","A"] }, 
{ name: "<span title=\"num: Double\">num</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.991766</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.437662</span></span>"] }, 
{ name: "<span title=\"date: kotlinx.datetime.LocalDate\">date</span>", children: [], rightAlign: false, values: ["1998-01-20","1998-12-25"] }, 
], id: 469762078, rootId: 469762075, totalRows: 2 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"letter: String\">letter</span>", children: [], rightAlign: false, values: ["A","A"] }, 
{ name: "<span title=\"num: Double\">num</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">-0.858192</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">-1.598537</span></span>"] }, 
{ name: "<span title=\"date: kotlinx.datetime.LocalDate\">date</span>", children: [], rightAlign: false, values: ["1999-11-21","1999-02-09"] }, 
], id: 469762079, rootId: 469762075, totalRows: 2 } ) });
/*-->*/

/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"letter: String\">letter</span>", children: [], rightAlign: false, values: ["C"] }, 
{ name: "<span title=\"num: Double\">num</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.676221</span></span>"] }, 
{ name: "<span title=\"date: kotlinx.datetime.LocalDate\">date</span>", children: [], rightAlign: false, values: ["1999-03-12"] }, 
], id: 469762080, rootId: 469762075, totalRows: 1 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(469762075) });


        </script>
        </html></div></div>
</div>
<p>Where the function invocation is a little more explicit than the panda’s one.</p>
<p>In contrast to Kotlin DataFrame, pandas <code class="docutils literal notranslate"><span class="pre">groupby</span></code> and <code class="docutils literal notranslate"><span class="pre">apply</span></code> function are way more powerful when grouping and applying functions when slicing data up into buckets with bins or by sample  quantiles (using the function <code class="docutils literal notranslate"><span class="pre">cut</span></code> and <code class="docutils literal notranslate"><span class="pre">qcut</span></code>). Kotlin DataFrame does not provide a way to handle <code class="docutils literal notranslate"><span class="pre">Categorical</span></code> object easily as in pandas, but some turnarounds can be made in order to emulate the behavior of pandas.</p>
</section>
</section>
<section id="pivot-tables-and-cross-tabulation">
<h2>Pivot Tables and Cross Tabulation<a class="headerlink" href="#pivot-tables-and-cross-tabulation" title="Permalink to this heading">#</a></h2>
<p>The pandas method <code class="docutils literal notranslate"><span class="pre">pivot_table</span></code> summarizes the joint use of <code class="docutils literal notranslate"><span class="pre">groupBy</span></code> and <code class="docutils literal notranslate"><span class="pre">pivot</span></code> in Kotlin Dataframe:</p>
<ul class="simple">
<li><p>The list of values specified in the pivot table, are the ones used for compute an aggregate function in Kotlin DataFrame’s <code class="docutils literal notranslate"><span class="pre">aggregate</span></code> function body.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">index</span></code> list provided to <code class="docutils literal notranslate"><span class="pre">pivot_table</span></code>, is represented by the list of column names inside the Kotlin DataFrame <code class="docutils literal notranslate"><span class="pre">groupBy</span></code> method.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">columns</span></code> list is represented by the list of column names inside the Kotlin DataFrame’s <code class="docutils literal notranslate"><span class="pre">pivot</span></code> function.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">aggfunc</span></code> parameter in Kotlin is specified inside the <code class="docutils literal notranslate"><span class="pre">aggregate</span></code> function body.</p></li>
</ul>
<p>Let’s consider some examples with the <code class="docutils literal notranslate"><span class="pre">tips</span></code> dataset. (More about this dataset in the examples at the end of this document)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="nv">tips</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DataFrame</span><span class="p">.</span><span class="na">readCSV</span><span class="p">(</span><span class="s">&quot;../resources/example-datasets/datasets/tips.csv&quot;</span><span class="p">)</span>
<span class="n">tips</span><span class="p">.</span><span class="na">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_469762081"></table>

<p class="dataframe_description">DataFrame: rowsCount = 5, columnsCount = 7</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"total_bill: Double\">total_bill</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">16.99</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">10.34</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">21.01</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">23.68</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">24.59</span></span>"] }, 
{ name: "<span title=\"tip: Double\">tip</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.01</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.66</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3.50</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3.31</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3.61</span></span>"] }, 
{ name: "<span title=\"sex: String\">sex</span>", children: [], rightAlign: false, values: ["Female","Male","Male","Male","Female"] }, 
{ name: "<span title=\"smoker: Boolean\">smoker</span>", children: [], rightAlign: false, values: ["false","false","false","false","false"] }, 
{ name: "<span title=\"day: String\">day</span>", children: [], rightAlign: false, values: ["Sun","Sun","Sun","Sun","Sun"] }, 
{ name: "<span title=\"time: String\">time</span>", children: [], rightAlign: false, values: ["Dinner","Dinner","Dinner","Dinner","Dinner"] }, 
{ name: "<span title=\"size: Int\">size</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">4</span></span>"] }, 
], id: 469762081, rootId: 469762081, totalRows: 5 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(469762081) });


        </script>
        </html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="p">.</span><span class="na">groupBy</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">day</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">smoker</span><span class="w"> </span><span class="p">}.</span><span class="na">sortBy</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">day</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">smoker</span><span class="w"> </span><span class="p">}.</span><span class="na">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_469762082"></table>

<p class="dataframe_description">DataFrame: rowsCount = 8, columnsCount = 5</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"day: String\">day</span>", children: [], rightAlign: false, values: ["Fri","Fri","Sat","Sat","Sun","Sun","Thur","Thur"] }, 
{ name: "<span title=\"smoker: Boolean\">smoker</span>", children: [], rightAlign: false, values: ["false","true","false","true","false","true","false","true"] }, 
{ name: "<span title=\"total_bill: Double\">total_bill</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">18.420000</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">16.813333</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">19.661778</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">21.276667</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">20.506667</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">24.120000</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">17.113111</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">19.190588</span></span>"] }, 
{ name: "<span title=\"tip: Double\">tip</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.812500</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.714000</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3.102889</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.875476</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3.167895</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3.516842</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.673778</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3.030000</span></span>"] }, 
{ name: "<span title=\"size: Double\">size</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.250000</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.066667</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.555556</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.476190</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.929825</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.578947</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.488889</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.352941</span></span>"] }, 
], id: 469762082, rootId: 469762082, totalRows: 8 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(469762082) });


        </script>
        </html></div></div>
</div>
<p>In python we could have accomplished the same result with the use of pivot table as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="s1">&#39;smoker&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>and by default, the aggregation function used is the mean of the data.</p>
<p>Note that in the following examples we are using the <code class="docutils literal notranslate"><span class="pre">sortBy</span></code> method for sticking to the output that pandas would provide.</p>
<p>We could now create a more sophisticated pivot table with this python snippet:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="p">[</span><span class="s1">&#39;tips_pct&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tips</span><span class="p">[</span><span class="s1">&#39;tip&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">tips</span><span class="p">[</span><span class="s1">&#39;total_bill&#39;</span><span class="p">]</span>
<span class="n">tips</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">([</span><span class="s1">&#39;tips_pct&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">],</span>
                 <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;smoker&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>And in Kotlin that pivot table can be created with:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;tips_pct&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">tip</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">total_bill</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">.</span><span class="na">groupBy</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">day</span><span class="w"> </span><span class="p">}.</span><span class="na">sortBy</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">day</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">.</span><span class="na">pivot</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">smoker</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">.</span><span class="na">aggregate</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">mean</span><span class="p">(</span><span class="s">&quot;tips_pct&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="s">&quot;tips_pct&quot;</span><span class="w"> </span>
<span class="w">        </span><span class="n">mean</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="s">&quot;size&quot;</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <html>
        <head>
            <style type="text/css">
                :root {
    --background: #fff;
    --background-odd: #f5f5f5;
    --background-hover: #d9edfd;
    --header-text-color: #474747;
    --text-color: #848484;
    --text-color-dark: #000;
    --text-color-medium: #737373;
    --text-color-pale: #b3b3b3;
    --inner-border-color: #aaa;
    --bold-border-color: #000;
    --link-color: #296eaa;
    --link-color-pale: #296eaa;
    --link-hover: #1a466c;
}

:root[theme="dark"], :root [data-jp-theme-light="false"], .dataframe_dark{
    --background: #303030;
    --background-odd: #3c3c3c;
    --background-hover: #464646;
    --header-text-color: #dddddd;
    --text-color: #b3b3b3;
    --text-color-dark: #dddddd;
    --text-color-medium: #b2b2b2;
    --text-color-pale: #737373;
    --inner-border-color: #707070;
    --bold-border-color: #777777;
    --link-color: #008dc0;
    --link-color-pale: #97e1fb;
    --link-hover: #00688e;
}

p.dataframe_description {
    color: var(--text-color-dark);
}

table.dataframe {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    background-color: var(--background);
    color: var(--text-color-dark);
    border: none;
    border-collapse: collapse;
}

table.dataframe th, td {
    padding: 6px;
    border: 1px solid transparent;
    text-align: left;
}

table.dataframe th {
    background-color: var(--background);
    color: var(--header-text-color);
}

table.dataframe td {
    vertical-align: top;
}

table.dataframe th.bottomBorder {
    border-bottom-color: var(--bold-border-color);
}

table.dataframe tbody > tr:nth-child(odd) {
    background: var(--background-odd);
}

table.dataframe tbody > tr:nth-child(even) {
    background: var(--background);
}

table.dataframe tbody > tr:hover {
    background: var(--background-hover);
}

table.dataframe a {
    cursor: pointer;
    color: var(--link-color);
    text-decoration: none;
}

table.dataframe tr:hover > td a {
    color: var(--link-color-pale);
}

table.dataframe a:hover {
    color: var(--link-hover);
    text-decoration: underline;
}

table.dataframe img {
    max-width: fit-content;
}

table.dataframe th.complex {
    background-color: var(--background);
    border: 1px solid var(--background);
}

table.dataframe .leftBorder {
    border-left-color: var(--inner-border-color);
}

table.dataframe .rightBorder {
    border-right-color: var(--inner-border-color);
}

table.dataframe .rightAlign {
    text-align: right;
}

table.dataframe .expanderSvg {
    width: 8px;
    height: 8px;
    margin-right: 3px;
}

table.dataframe .expander {
    display: flex;
    align-items: center;
}

/* formatting */

table.dataframe .null {
    color: var(--text-color-pale);
}

table.dataframe .structural {
    color: var(--text-color-medium);
    font-weight: bold;
}

table.dataframe .dataFrameCaption {
    font-weight: bold;
}

table.dataframe .numbers {
    color: var(--text-color-dark);
}

table.dataframe td:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}

table.dataframe tr:hover .formatted .structural, .null {
    color: var(--text-color-dark);
}




            </style>
        </head>
        <body>
            
<table class="dataframe" id="df_469762083"></table>

<p class="dataframe_description">DataFrame: rowsCount = 6, columnsCount = 3</p>
        </body>
        <script>
            
/*<!--*/
call_DataFrame(function() { DataFrame.addTable({ cols: [{ name: "<span title=\"time: String\">time</span>", children: [], rightAlign: false, values: ["Dinner","Dinner","Dinner","Dinner","Lunch","Lunch"] }, 
{ name: "<span title=\"day: String\">day</span>", children: [], rightAlign: false, values: ["Fri","Sat","Sun","Thur","Fri","Thur"] }, 
{ name: "<span title=\"tips_pct: Double?\">tips_pct</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.165347</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.147906</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.187250</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.188937</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.163863</span></span>"] }, 
{ name: "<span title=\"size: Double?\">size</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.222222</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.476190</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.578947</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">null</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">1.833333</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.352941</span></span>"] }, 
{ name: "<span title=\"true: DataRow\">true</span>", children: [2, 3], rightAlign: false, values: ["<span class=\"formatted\" title=\"tips_pct: 0.16534735890795094\nsize: 2.2222222222222223\"><span class=\"structural\">{ </span><span class=\"structural\">tips_pct: </span><span class=\"numbers\">0.2</span><span class=\"structural\">, </span><span class=\"structural\">size: </span><span class=\"numbers\">2.2</span><span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"tips_pct: 0.14790606514920887\nsize: 2.4761904761904763\"><span class=\"structural\">{ </span><span class=\"structural\">tips_pct: </span><span class=\"numbers\">0.1</span><span class=\"structural\">, </span><span class=\"structural\">size: </span><span class=\"numbers\">2.5</span><span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"tips_pct: 0.18725031625235425\nsize: 2.5789473684210527\"><span class=\"structural\">{ </span><span class=\"structural\">tips_pct: </span><span class=\"numbers\">0.2</span><span class=\"structural\">, </span><span class=\"structural\">size: </span><span class=\"numbers\">2.6</span><span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"\"><span class=\"null\">{ }</span></span>","<span class=\"formatted\" title=\"tips_pct: 0.18893659162141405\nsize: 1.8333333333333333\"><span class=\"structural\">{ </span><span class=\"structural\">tips_pct: </span><span class=\"numbers\">0.2</span><span class=\"structural\">, </span><span class=\"structural\">size: </span><span class=\"numbers\">1.8</span><span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"tips_pct: 0.16386327213341778\nsize: 2.3529411764705883\"><span class=\"structural\">{ </span><span class=\"structural\">tips_pct: </span><span class=\"numbers\">0.2</span><span class=\"structural\">, </span><span class=\"structural\">size: </span><span class=\"numbers\">2.4</span><span class=\"structural\"> }</span></span>"] }, 
{ name: "<span title=\"tips_pct: Double\">tips_pct</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.139622</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.158048</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.160113</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.159744</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.187735</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">0.160311</span></span>"] }, 
{ name: "<span title=\"size: Double\">size</span>", children: [], rightAlign: true, values: ["<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.000000</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.555556</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.929825</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.000000</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">3.000000</span></span>","<span class=\"formatted\" title=\"\"><span class=\"numbers\">2.500000</span></span>"] }, 
{ name: "<span title=\"false: DataRow\">false</span>", children: [5, 6], rightAlign: false, values: ["<span class=\"formatted\" title=\"tips_pct: 0.13962236590021224\nsize: 2.0\"><span class=\"structural\">{ </span><span class=\"structural\">tips_pct: </span><span class=\"numbers\">0.1</span><span class=\"structural\">, </span><span class=\"structural\">size: </span><span class=\"numbers\">2.0</span><span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"tips_pct: 0.15804765754377617\nsize: 2.5555555555555554\"><span class=\"structural\">{ </span><span class=\"structural\">tips_pct: </span><span class=\"numbers\">0.2</span><span class=\"structural\">, </span><span class=\"structural\">size: </span><span class=\"numbers\">2.6</span><span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"tips_pct: 0.16011294305072807\nsize: 2.9298245614035086\"><span class=\"structural\">{ </span><span class=\"structural\">tips_pct: </span><span class=\"numbers\">0.2</span><span class=\"structural\">, </span><span class=\"structural\">size: </span><span class=\"numbers\">2.9</span><span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"tips_pct: 0.1597444089456869\nsize: 2.0\"><span class=\"structural\">{ </span><span class=\"structural\">tips_pct: </span><span class=\"numbers\">0.2</span><span class=\"structural\">, </span><span class=\"structural\">size: </span><span class=\"numbers\">2.0</span><span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"tips_pct: 0.18773466833541927\nsize: 3.0\"><span class=\"structural\">{ </span><span class=\"structural\">tips_pct: </span><span class=\"numbers\">0.2</span><span class=\"structural\">, </span><span class=\"structural\">size: </span><span class=\"numbers\">3.0</span><span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"tips_pct: 0.16031066524359844\nsize: 2.5\"><span class=\"structural\">{ </span><span class=\"structural\">tips_pct: </span><span class=\"numbers\">0.2</span><span class=\"structural\">, </span><span class=\"structural\">size: </span><span class=\"numbers\">2.5</span><span class=\"structural\"> }</span></span>"] }, 
{ name: "<span title=\"smoker: DataRow\">smoker</span>", children: [4, 7], rightAlign: false, values: ["<span class=\"formatted\" title=\"true: { tips_pct:0.165347, size:2.222222 }\nfalse: { tips_pct:0.139622, size:2.000000 }\"><span class=\"structural\">{ </span><span class=\"structural\">true: </span><span class=\"structural\">{ </span><span class=\"structural\">tips_pct: </span><span class=\"numbers\">0.2</span><span class=\"structural\">, </span><span class=\"structural\">si...</span><span class=\"structural\"> }</span><span class=\"structural\">, </span><span class=\"structural\">f...</span><span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"true: { tips_pct:0.147906, size:2.476190 }\nfalse: { tips_pct:0.158048, size:2.555556 }\"><span class=\"structural\">{ </span><span class=\"structural\">true: </span><span class=\"structural\">{ </span><span class=\"structural\">tips_pct: </span><span class=\"numbers\">0.1</span><span class=\"structural\">, </span><span class=\"structural\">si...</span><span class=\"structural\"> }</span><span class=\"structural\">, </span><span class=\"structural\">f...</span><span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"true: { tips_pct:0.187250, size:2.578947 }\nfalse: { tips_pct:0.160113, size:2.929825 }\"><span class=\"structural\">{ </span><span class=\"structural\">true: </span><span class=\"structural\">{ </span><span class=\"structural\">tips_pct: </span><span class=\"numbers\">0.2</span><span class=\"structural\">, </span><span class=\"structural\">si...</span><span class=\"structural\"> }</span><span class=\"structural\">, </span><span class=\"structural\">f...</span><span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"false: { tips_pct:0.159744, size:2.000000 }\"><span class=\"structural\">{ </span><span class=\"structural\">false: </span><span class=\"structural\">{ </span><span class=\"structural\">tips_pct: </span><span class=\"numbers\">0.2</span><span class=\"structural\">, </span><span class=\"structural\">size: </span><span class=\"numbers\">2.0</span><span class=\"structural\"> }</span><span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"true: { tips_pct:0.188937, size:1.833333 }\nfalse: { tips_pct:0.187735, size:3.000000 }\"><span class=\"structural\">{ </span><span class=\"structural\">true: </span><span class=\"structural\">{ </span><span class=\"structural\">tips_pct: </span><span class=\"numbers\">0.2</span><span class=\"structural\">, </span><span class=\"structural\">si...</span><span class=\"structural\"> }</span><span class=\"structural\">, </span><span class=\"structural\">f...</span><span class=\"structural\"> }</span></span>","<span class=\"formatted\" title=\"true: { tips_pct:0.163863, size:2.352941 }\nfalse: { tips_pct:0.160311, size:2.500000 }\"><span class=\"structural\">{ </span><span class=\"structural\">true: </span><span class=\"structural\">{ </span><span class=\"structural\">tips_pct: </span><span class=\"numbers\">0.2</span><span class=\"structural\">, </span><span class=\"structural\">si...</span><span class=\"structural\"> }</span><span class=\"structural\">, </span><span class=\"structural\">f...</span><span class=\"structural\"> }</span></span>"] }, 
], id: 469762083, rootId: 469762083, totalRows: 6 } ) });
/*-->*/

call_DataFrame(function() { DataFrame.renderTable(469762083) });


        </script>
        </html></div></div>
</div>
<p>So a deep understanding of the pandas <code class="docutils literal notranslate"><span class="pre">pivot_table</span></code> method, can really helps a lot when it comes to learning how to pivot and rearrange the dataset using Kotlin DataFrame!</p>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this heading">#</a></h2>
<p>This process of data aggregation and the application of the split-apply-combine strategy can help both data cleaning as well as modeling or statistical analysis work, and as we have seen in this chapter, Kotlin DataFrame offers almost the same pandas capabilities when it come to those operations, especially when pivoting tables.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "kotlin"
        },
        kernelOptions: {
            name: "kotlin",
            path: "./ch7"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'kotlin'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="intro_aggregation_grouping.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Data Aggregation and Group Operations</p>
      </div>
    </a>
    <a class="right-next"
       href="../DA_examples/DA_Introduction.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Data Analysis Examples</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#split">Split</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregation-apply-and-combine">Aggregation (Apply and Combine)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#apply"><code class="docutils literal notranslate"><span class="pre">apply</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pivot-tables-and-cross-tabulation">Pivot Tables and Cross Tabulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Stefano Furi
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>